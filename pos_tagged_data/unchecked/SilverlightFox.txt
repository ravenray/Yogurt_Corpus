It/PRP depends/VBZ on/IN the/DT initial/JJ value/NN of/IN errorMessage/NN ./.
As/IN you/PRP are/VBP appending/VBG to/TO it/PRP ,/, it/PRP is/VBZ not/RB possible/JJ to/TO see/VB from/IN your/PRP$ code/NN what/WP it/PRP already/RB contains/VBZ ./.
The/DT encoding/NN should/MD be/VB done/VBN when/WRB output/NN to/TO guard/VB against/IN any/DT possible/JJ DOM/NNP Based/VBN XSS/NN ./.
i.e./FW document.writeln/FW -LRB-/-LRB- ''/'' </JJR input/NN type/NN =\/CD ``/`` hidden/JJ \/NN ''/'' name/NN =\/NN ``/`` errorMessage/FW \/FW ''/'' value/NN =\/NN ''/'' ''/'' +/CC encodeHTML/NN -LRB-/-LRB- errorMessage/NN -RRB-/-RRB- +/CC ''/'' \/NN ''/'' >/JJR ''/'' -RRB-/-RRB- ;/: Also/RB ,/, do/VBP n't/RB forget/VB to/TO encode/VB single/JJ quote/NN ./.
You/PRP should/MD make/VB sure/JJ that/IN http://loginPageURLGoesHere/NN correctly/RB sanitises/VBZ the/DT errorMessage/NN POSTed/VBD to/TO it/PRP before/IN output/NN to/TO guard/VB against/IN regular/JJ XSS/NN ./.
Yes/NNP -/: I/PRP always/RB encode/VBP at/IN point/NN of/IN output/NN ,/, or/CC name/VB my/PRP$ variable/NN in/IN such/JJ as/IN way/NN to/TO indicate/VB that/IN it/PRP has/VBZ already/RB been/VBN encoded/VBN ./.
On/IN the/DT web/NN based/JJ side/NN of/IN things/NNS ,/, C#/NN -LRB-/-LRB- and/CC more/RBR generally/RB ,/, ASP.NET/NN -RRB-/-RRB- is/VBZ commonly/RB vulnerable/JJ to/TO the/DT following/JJ -LRB-/-LRB- items/NNS listed/VBN by/IN OWASP/NNP Top/NNP 10/CD 2013/CD -RRB-/-RRB- ./.
I/PRP realise/VBP you/PRP were/VBD mainly/RB interested/JJ in/IN sink/NN functions/NNS ,/, of/IN which/WDT I/PRP cover/VBP some/DT ,/, however/RB you/PRP did/VBD ask/VB how/WRB people/NNS accidentally/RB make/VBP dangerous/JJ C#/NN code/NN so/RB hopefully/RB I/PRP 've/VBP provided/VBN some/DT insight/NN here/RB ./.
A1-Injection/NN SQL/NN Injection/NN Generating/NNP queries/NNS by/IN string/NN concatenation/NN ./.
var/NN sql/NN =/JJ ``/`` SELECT/VB */SYM FROM/NNP UserAccount/NNP WHERE/NNP Username/NNP =/JJ '/'' ''/'' +/CC username/JJ ''/'' '/'' ''/'' ;/: SqlCommand/NNP command/NN =/JJ new/JJ SqlCommand/NN -LRB-/-LRB- sql/NN ,/, connection/NN -RRB-/-RRB- ;/: SqlDataReader/NNP reader/NN =/JJ command.ExecuteReader/NN -LRB-/-LRB- -RRB-/-RRB- ;/: This/DT can/MD often/RB be/VB solved/VBN by/IN parameterised/JJ queries/NNS ,/, but/CC if/IN you/PRP are/VBP using/VBG an/DT IN/IN condition/NN it/PRP currently/RB is/VBZ n't/RB possible/JJ without/IN string/NN concatenation/NN ./.
LDAP/NN Injection/NN Code/NNP such/JJ as/IN searcher.Filter/NN =/JJ string.Format/NN -LRB-/-LRB- ''/'' -LRB-/-LRB- sAMAccountName/NN =/JJ -LCB-/-LRB- 1/CD -RCB-/-RRB- -RRB-/-RRB- ''/'' ,/, loginName/NN -RRB-/-RRB- ;/: can/MD make/VB the/DT application/NN vulnerable/JJ ./.
More/JJR information/NN here/RB ./.
OS/NN Command/NN Injection/NN This/DT code/NN is/VBZ vulnerable/JJ to/TO command/VB injection/NN because/IN the/DT second/JJ parameter/NN to/TO Process.Start/NN can/MD have/VB extra/JJ commands/NNS passed/VBN to/TO it/PRP using/VBG the/DT &/CC character/NN to/TO batch/NN multiple/NN commands/VBZ string/NN strCmdText/NN =/JJ @/SYM ''/'' //: C/NN dir/NN c/NN :/: \/CD files/NNS \/CD ''/'' +/CC Request.QueryString/NN -LSB-/-LRB- ``/`` dir/NN ''/'' -RSB-/-RRB- ;/: ProcessStartInfo/NNP info/NN =/JJ new/JJ ProcessStartInfo/NNP -LRB-/-LRB- ``/`` CMD.exe/NN ''/'' ,/, strCmdText/NN -RRB-/-RRB- ;/: Process.Start/NN -LRB-/-LRB- info/NN -RRB-/-RRB- ;/: e.g./FW foldername/FW &/CC &/CC ipconfig/JJ A2-Broken/NN Authentication/NN and/CC Session/NN Management/NNP Sign/NNP Out/IN The/DT default/NN Forms/NNP Authentication/NNP SignOut/NNP method/NN does/VBZ not/RB update/VB anything/NN server/NN side/NN ,/, allowing/VBG a/DT captured/VBN auth/NN token/JJ to/TO be/VB continued/VBN to/TO be/VB used/VBN ./.
Calling/VBG the/DT SignOut/NNP method/NN only/RB removes/VBZ the/DT forms/NNS authentication/NN cookie/NN ./.
The/DT Web/NN server/NN does/VBZ not/RB store/VB valid/JJ and/CC expired/VBD authentication/NN tickets/NNS for/IN later/JJ comparison/NN ./.
This/DT makes/VBZ your/PRP$ site/NN vulnerable/JJ to/TO a/DT replay/NN attack/NN if/IN a/DT malicious/JJ user/NN obtains/VBZ a/DT valid/JJ forms/NNS authentication/NN cookie/NN ./.
Using/VBG Session/NN State/NN for/IN Authentication/NN A/NN session/NN fixation/NN vulnerability/NN could/MD be/VB present/JJ if/IN a/DT user/NN has/VBZ used/VBN session/NN state/NN for/IN authentication/NN ./.
A3-Cross-Site/JJ Scripting/NN -LRB-/-LRB- XSS/NN -RRB-/-RRB- Response.Write/NN -LRB-/-LRB- and/CC the/DT shortcut/NN </JJR %/NN =/JJ =/JJ >/JJR -RRB-/-RRB- vulnerable/JJ by/IN default/NN ,/, unless/IN the/DT developer/NN has/VBZ remembered/VBN to/TO HTML/NNP encode/VBP the/DT output/NN ./.
The/DT more/RBR recent/JJ shortcut/NN </JJR %/NN :/: HTML/NNP encodes/VBZ by/IN default/NN ,/, although/IN some/DT developers/NNS may/MD use/VB this/DT to/TO insert/VB values/NNS into/IN JavaScript/NNP where/WRB they/PRP can/MD still/RB be/VB escaped/VBN by/IN an/DT attacker/NN ./.
Even/RB using/VBG the/DT modern/JJ Razor/NNP engine/NN it/PRP is/VBZ difficult/JJ to/TO get/VB this/DT right/NN :/: var/NN name/NN =/JJ '/'' @Html/NN ./.
Raw/NN -LRB-/-LRB- HttpUtility.JavaScriptStringEncode/NN -LRB-/-LRB- Model.Name/NN -RRB-/-RRB- -RRB-/-RRB- '/'' ;/: ASP.NET/NN by/IN default/NN enables/VBZ Request/NNP Validation/NNP ,/, which/WDT will/MD block/VB any/DT input/NN from/IN cookies/NNS ,/, the/DT query/NN string/NN and/CC from/IN POST/NN data/NNS that/WDT could/MD potentially/RB be/VB malicious/JJ -LRB-/-LRB- e.g./FW HTML/NNP tags/NNS -RRB-/-RRB- ./.
This/DT appears/VBZ to/TO cope/VB well/RB with/IN input/NN coming/VBG through/IN the/DT particular/JJ app/NN ,/, but/CC if/IN there/EX is/VBZ content/NN in/IN the/DT database/NN that/WDT is/VBZ inserted/VBN from/IN other/JJ sources/NNS like/IN from/IN an/DT app/NN written/VBN using/VBG other/JJ technologies/NNS ,/, then/RB it/PRP is/VBZ possible/JJ that/IN malicious/JJ script/NN code/NN could/MD still/RB be/VB output/NN ./.
In/IN old/JJ versions/NNS of/IN ./.
NET/NN it/PRP was/VBD a/DT bit/NN of/IN a/DT mine-field/NN for/IN a/DT developer/NN to/TO ensure/VB that/IN their/PRP$ output/NN was/VBD correctly/RB encoded/VBN using/VBG some/DT of/IN the/DT default/NN web/NN controls/NNS ./.
Unfortunately/RB ,/, the/DT data-binding/JJ syntax/NN does/VBZ n't/RB yet/RB contain/VB a/DT built-in/JJ encoding/NN syntax/NN ;/: it/PRP 's/VBZ coming/VBG in/IN the/DT next/JJ version/NN of/IN ASP.NET/FW e.g./FW not/RB vulnerable/JJ :/: <asp:Repeater ID="Repeater1" runat="server">/FW <ItemTemplate>/FW </JJR asp/NN :/: TextBox/NN ID/NN =/JJ ``/`` txtYourField/NN ''/'' Text/VB =/JJ '/'' </JJR %/NN #/# Bind/VB -LRB-/-LRB- ``/`` YourField/NNP ''/'' -RRB-/-RRB- %/NN >/JJR '/POS runat/NN =/JJ ``/`` server/NN ''/'' >/JJR </asp:TextBox>/NN </ItemTemplate>/NN </asp:Repeater>/NN vulnerable/JJ :/: <asp:Repeater ID="Repeater2" runat="server">/FW <ItemTemplate>/FW </JJR %/NN #/# Eval/NNP -LRB-/-LRB- ``/`` YourField/NNP ''/'' -RRB-/-RRB- %/NN >/JJR </ItemTemplate>/FW </asp:Repeater>/FW A4-Insecure/NN Direct/NNP Object/NNP References/NNPS MVC/NNP model/NN binding/NN can/MD allow/VB parameters/NNS added/VBN to/TO POST/NN data/NNS to/TO be/VB mapped/VBN onto/IN the/DT a/DT data/NN model/NN ./.
This/DT can/MD happen/VB unintentionally/RB as/IN the/DT developer/NN has/VBZ n't/RB realised/VBN that/IN a/DT malicious/JJ user/NN may/MD amend/VB parameters/NNS in/IN this/DT way/NN ./.
The/DT Bind/NNP attribute/NN can/MD be/VB used/VBN to/TO prevent/VB this/DT ./.
A5-Security/NN Misconfiguration/NN There/EX are/VBP many/JJ configuration/NN options/NNS that/WDT can/MD weaken/VB the/DT security/NN of/IN an/DT application/NN ./.
For/IN example/NN setting/VBG customErrors/NNS to/TO On/NNP or/CC enabling/VBG trace/NN ./.
Scanners/NNS such/JJ as/IN ASafaWeb/NN can/MD check/VB for/IN this/DT common/JJ misconfigurations/NNS ./.
A6-Sensitive/JJ Data/NNP Exposure/NN Default/NNP Hashing/NNP The/NNP default/NN password/NN hashing/VBG methods/NNS in/IN ASP.NET/NN are/VBP sometimes/RB not/RB the/DT best/JJS ./.
HashPasswordForStoringInConfigFile/NN -LRB-/-LRB- -RRB-/-RRB- -/: this/DT could/MD also/RB be/VB bad/JJ if/IN it/PRP is/VBZ used/VBN to/TO hash/VB a/DT plain/JJ password/NN with/IN no/DT added/VBN salt/NN ./.
Article/NNP ``/`` Our/PRP$ password/NN hashing/VBG has/VBZ no/DT clothes/NNS ''/'' regarding/VBG the/DT ASP.NET/NN membership/NN provider/NN in/IN ./.
NET/NN 4/CD ./.
A7-Missing/JJ Function/NN Level/NN Access/NN Control/NN Failure/NN to/TO Restrict/VB URL/NN Access/NN In/IN integrated/VBN pipeline/NN mode/NN ./.
NET/NN can/MD see/VB every/DT request/NN and/CC handles/VBZ can/MD authorise/VB each/DT request/NN ,/, even/RB to/TO non/JJ ./.
NET/NN resources/NNS -LRB-/-LRB- e.g./FW ./.
js/NNS and/CC images/NNS -RRB-/-RRB- ./.
However/RB ,/, if/IN the/DT application/NN i/FW running/VBG in/IN classic/JJ mode/NN ,/, ./.
NET/NNP only/RB sees/VBZ requests/NNS to/TO files/NNS such/JJ as/IN ./.
aspx/NN so/IN other/JJ files/NNS may/MD be/VB accidentally/RB unsecured/JJ ./.
See/VB this/DT answer/NN for/IN more/JJR detail/NN on/IN the/DT differences/NNS ./.
e.g./FW www.example.com/images/private_photograph_user1.jpg/FW is/VBZ more/RBR likely/JJ to/TO be/VB vulnerable/JJ in/IN an/DT application/NN that/WDT runs/VBZ in/IN classic/JJ mode/NN ,/, although/IN there/EX are/VBP workarounds/NNS ./.
A8-Cross-Site/FW Request/FW Forgery/NN -LRB-/-LRB- CSRF/NN -RRB-/-RRB- Although/IN the/DT legacy/NN web/NN forms/VBZ applications/NNS are/VBP usually/RB more/RBR secure/JJ against/IN CSRF/NN due/JJ to/TO requiring/VBG the/DT attacker/NN to/TO forge/VB the/DT View/NNP State/NNP and/CC Event/NNP Validation/NNP values/NNS ,/, newer/JJR MVC/NNP applications/NNS could/MD be/VB vulnerable/JJ unless/IN the/DT developer/NN has/VBZ manually/RB implemented/VBN anti/JJ forgery/NN tokens/NNS ./.
Note/VB I/PRP am/VBP not/RB saying/VBG that/IN web/NN forms/NNS is/VBZ not/RB vulnerable/JJ ,/, just/RB that/IN it/PRP is/VBZ more/RBR difficult/JJ that/IN simply/RB passing/VBG on/IN a/DT few/JJ basic/JJ parameters/NNS -/: there/EX are/VBP fixes/NNS though/RB ,/, such/JJ as/IN integrating/VBG the/DT user/NN key/NN into/IN the/DT View/NNP State/NNP value/NN ./.
When/WRB the/DT EnableEventValidation/NNP property/NN is/VBZ set/VBN to/TO true/JJ ,/, ASP.NET/NN validates/VBZ that/IN a/DT control/NN event/NN originated/VBD from/IN the/DT user/NN interface/NN that/WDT was/VBD rendered/VBN by/IN that/DT control/NN ./.
A/DT control/NN registers/VBZ its/PRP$ events/NNS during/IN rendering/NN and/CC then/RB validates/VBZ the/DT events/NNS during/IN postback/NN or/CC callback/NN handling/NN ./.
For/IN example/NN ,/, if/IN a/DT list/NN control/NN includes/VBZ options/NNS numbered/VBD 1/CD ,/, 2/CD ,/, or/CC 3/CD when/WRB the/DT page/NN is/VBZ rendered/VBN ,/, and/CC if/IN a/DT postback/JJ request/NN is/VBZ received/VBN specifying/VBG option/NN number/NN 4/CD ,/, ASP.NET/NN raises/VBZ an/DT exception/NN ./.
All/DT event-driven/JJ controls/NNS in/IN ASP.NET/NN use/VBP this/DT feature/NN by/IN default/NN ./.
-LSB-/-LRB- EnableEventValidation/NN -RSB-/-RRB- feature/NN reduces/VBZ the/DT risk/NN of/IN unauthorized/JJ or/CC malicious/JJ postback/NN requests/NNS and/CC callbacks/NNS ./.
It/PRP is/VBZ strongly/RB recommended/VBN that/IN you/PRP do/VBP not/RB disable/VB event/NN validation/NN ./.
A10-Unvalidated/JJ -/: Redirects/NNS and/CC Forwards/NNS Adding/VBG code/NN such/JJ as/IN Response.Redirect/NN -LRB-/-LRB- Request.QueryString/NN -LSB-/-LRB- ``/`` Url/NNP ''/'' -RSB-/-RRB- -RRB-/-RRB- ;/: will/MD make/VB your/PRP$ site/NN vulnerable/JJ ./.
The/DT attack/NN could/MD be/VB initiated/VBN by/IN sending/VBG a/DT phishing/VBG email/NN to/TO a/DT user/NN containing/VBG a/DT link/NN ./.
If/IN the/DT user/NN is/VBZ vigilant/JJ they/PRP may/MD have/VB double/RB checked/VBN the/DT domain/NN of/IN the/DT URL/NN before/IN clicking/VBG ./.
However/RB ,/, as/IN the/DT domain/NN will/MD match/VB your/PRP$ domain/NN which/WDT the/DT user/NN trusts/NNS ,/, they/PRP will/MD click/VB the/DT link/NN unaware/JJ that/IN the/DT page/NN will/MD redirect/VB the/DT user/NN to/TO the/DT attacker/NN 's/POS domain/NN ./.
Validation/NNP should/MD take/VB place/NN on/IN Url/NN to/TO ensure/VB that/IN it/PRP is/VBZ either/CC a/DT relative/JJ ,/, allowed/JJ URL/NN or/CC an/DT absolute/JJ URL/NN to/TO one/CD of/IN your/PRP$ own/JJ allowed/JJ domains/NNS and/CC pages/NNS ./.
You/PRP may/MD want/VB to/TO check/VB someone/NN is/VBZ n't/RB redirecting/VBG your/PRP$ users/NNS to/TO //: Logout.aspx/NN for/IN example/NN ./.
Although/IN there/EX may/MD be/VB nothing/NN stopping/VBG an/DT attacker/NN from/IN directly/RB linking/VBG to/TO http://www.example.com/Logout.aspx/NN ,/, they/PRP could/MD use/VB the/DT redirect/NN to/TO hide/VB the/DT URL/NN so/IN it/PRP is/VBZ harder/RBR for/IN a/DT user/NN to/TO understand/VB which/WDT page/NN is/VBZ being/VBG accessed/VBN -LRB-/-LRB- http://www.example.com/Redirect.aspx?Url=%2f%4c%6f%67%6f%75%74%2e%61%73%70%78/NN -RRB-/-RRB- ./.
Others/NNS The/DT other/JJ OWASP/NN categories/NNS are/VBP :/: A9-Using/JJ Components/NNP with/IN Known/VBN Vulnerabilities/NNS of/IN which/WDT I/PRP ca/MD n't/RB think/VB of/IN any/DT to/TO mind/VB that/WDT are/VBP specific/JJ to/TO C#/NN //: ASP.NET/NN ./.
I/PRP 'll/MD update/VB my/PRP$ answer/NN if/IN I/PRP think/VBP of/IN any/DT -LRB-/-LRB- if/IN you/PRP think/VBP they/PRP are/VBP relevant/JJ to/TO your/PRP$ question/NN -RRB-/-RRB- ./.
