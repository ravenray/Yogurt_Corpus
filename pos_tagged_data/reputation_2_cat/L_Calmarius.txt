["I'/NP", 've/NNS', 'written/VVN', 'this/DT', 'little/JJ', 'function/NN', 'several/JJ', 'years/NNS', 'ago/RB', ':/:', 'function/NN', 'sqlvprintf/NN', '(/(', '$/$', 'query/NN', ',/,', '$/$', 'args/NNS', ')/)', '{/(', 'global/JJ', '$/$', 'DB_LINK/NP', ';/:', '$/$', 'ctr/JJ', '=/SYM', '0/CD', ';/:', 'ensureConnection/NN', '(/(', ')/)', ';/:', '//SYM', '//SYM', 'Connect/NN', 'to/TO', 'database/NN', 'if/IN', 'not/RB', 'connected/VVN', 'already/RB', './SENT', '$/$', 'values/NNS', '=/SYM', 'array/NN', '(/(', ')/)', ';/:', 'foreach/NP', '(/(', '$/$', 'args/NNS', 'as/IN', '$/$', 'value/NN', ')/)', '{/(', 'if/IN', '(/(', 'is_string/NN', '(/(', '$/$', 'value/NN', ')/)', ')/)', '{/(', '$/$', 'value/NN', '=/SYM', '"/\'\'', "'/''", '"/\'\'', './SENT', 'mysqli_real_escape_string/NN', '(/(', '$/$', 'DB_LINK/NP', ',/,', '$/$', 'value/NN', ')/)', './SENT', '"/\'\'', "'/''", '"/\'\'', ';/:', '}/)', 'else/RB', 'if/IN', '(/(', 'is_null/NN', '(/(', '$/$', 'value/NN', ')/)', ')/)', '{/(', '$/$', 'value/NN', '=/SYM', "'/POS", "NULL'/NP", ';/:', '}/)', 'else/RB', 'if/IN', '(/(', '!/SENT', 'is_int/NN', '(/(', '$/$', 'value/NN', ')/)', '!/SENT', 'is_float/NN', '(/(', '$/$', 'value/NN', ')/)', ')/)', '{/(', 'die/VV', '(/(', "'/POS", 'Only/RB', 'numeric/JJ', ',/,', 'string/NN', ',/,', 'array/NN', 'and/CC', 'NULL/JJ', 'arguments/NNS', 'allowed/VVN', 'in/IN', 'a/DT', 'query/NN', './SENT', 'Argument/NN', "'/POS", './SENT', '(/(', '$/$', 'ctr/JJ', '+/SYM', '1/CD', ')/)', './SENT', "'/''", 'is/VBZ', 'not/RB', 'a/DT', 'basic/JJ', 'type/NN', ',/,', 'it/PP', '\\/SYM', "'/POS", 's/NN', 'type/NN', 'is/VBZ', "'/''", './SENT', 'gettype/NN', '(/(', '$/$', 'value/NN', ')/)', './SENT', "'/''", './SENT', "'/''", ')/)', ';/:', '}/)', '$/$', 'values/NNS', '[/SYM', ']/SYM', '=/SYM', '$/$', 'value/NN', ';/:', '$/$', 'ctr/JJ', '+/SYM', '+/SYM', ';/:', '}/)', '$/$', 'query/NN', '=/SYM', 'preg_replace_callback/JJ', '(/(', "'/''", '//SYM', '{/(', '(/(', '\\/SYM', '\\/SYM', 'd/SYM', '+/SYM', ')/)', '}/)', '//SYM', "'/POS", ',/,', 'function/NN', '(/(', '$/$', 'match/VV', ')/)', 'use/NN', '(/(', '$/$', 'values/NNS', ')/)', '{/(', 'if/IN', '(/(', 'isset/NN', '(/(', '$/$', 'values/NNS', '[/SYM', '$/$', 'match/NN', '[/SYM', '1/CD', ']/SYM', ']/SYM', ')/)', ')/)', '{/(', 'return/VV', '$/$', 'values/NNS', '[/SYM', '$/$', 'match/NN', '[/SYM', '1/CD', ']/SYM', ']/SYM', ';/:', '}/)', 'else/RB', '{/(', 'return/VV', '$/$', 'match/NN', '[/SYM', '0/CD', ']/SYM', ';/:', '}/)', '}/)', ',/,', '$/$', 'query/NN', ')/)', ';/:', 'return/VV', '$/$', 'query/NN', ';/:', '}/)', 'function/NN', 'runEscapedQuery/NN', '(/(', '$/$', 'preparedQuery/JJ', '//SYM', '*/SYM', ',/,', '.../:', '*/SYM', '//SYM', ')/)', '{/(', '$/$', 'params/NNS', '=/SYM', 'array_slice/JJ', '(/(', 'func_get_args/NNS', '(/(', ')/)', ',/,', '1/CD', ')/)', ';/:', '$/$', 'results/NNS', '=/SYM', 'runQuery/JJ', '(/(', 'sqlvprintf/NN', '(/(', '$/$', 'preparedQuery/JJ', ',/,', '$/$', 'params/NNS', ')/)', ')/)', ';/:', '//SYM', '//SYM', 'Run/NN', 'query/NN', 'and/CC', 'fetch/VV', 'results/NNS', './SENT', 'return/VV', '$/$', 'results/NNS', ';/:', '}/)', 'This/DT', 'allows/VVZ', 'running/VVG', 'statements/NNS', 'in/IN', 'an/DT', 'one-liner/NN', 'C/NN', '#/#', '-ish/JJ', 'String/NP', './SENT', 'Format/NN', 'like/IN', ':/:', 'runEscapedQuery/NN', '(/(', '"/``', 'INSERT/NP', 'INTO/NP', 'Whatever/WDT', '(/(', 'id/NN', ',/,', 'foo/NP', ',/,', 'bar/NN', ')/)', 'VALUES/NNS', '(/(', '{/(', '0/CD', '}/)', ',/,', '{/(', '1/CD', '}/)', ',/,', '{/(', '2/LS', '}/)', ')/)', '"/``', ',/,', '$/$', 'numericVar/JJ', ',/,', '$/$', 'stringVar1/JJ', ',/,', '$/$', 'stringVar2/JJ', ')/)', ';/:', 'It/PP', 'escapes/VVZ', 'considering/VVG', 'the/DT', 'variable/JJ', 'type/NN', './SENT', 'If/IN', 'you/PP', 'try/VVP', 'to/TO', 'parameterize/VV', 'table/NN', ',/,', 'column/NN', 'names/NNS', ',/,', 'it/PP', 'would/MD', 'fail/VV', 'as/IN', 'it/PP', 'puts/VVZ', 'every/DT', 'string/NN', 'in/IN', 'quotes/NNS', 'which/WDT', 'is/VBZ', 'invalid/JJ', 'syntax/NN', './SENT', 'SECURITY/NN', 'UPDATE/NN', ':/:', 'The/DT', 'previous/JJ', 'str_replace/NN', 'version/NN', 'allowed/VVD', 'injections/NNS', 'by/IN', 'adding/VVG', '{/(', '#/#', '}/)', 'tokens/NNS', 'into/IN', 'user/NN', 'data/NNS', './SENT', 'This/DT', 'preg_replace_callback/NN', 'version/NN', "doesn'/NP", 't/NN', 'cause/NN', 'problems/NNS', 'if/IN', 'the/DT', 'replacement/NN', 'contains/VVZ', 'these/DT', 'tokens/NNS', './SENT', '@/SYM', 'YourCommonSense/JJ', 'Hmmm/NN', 'sprintf/NN', 'is/VBZ', 'useful/JJ', './SENT', 'But/CC', 'not/RB', 'necessarily/RB', 'here/RB', ',/,', 'as/IN', 'strings/NNS', 'need/VVP', 'to/TO', 'be/VB', 'properly/RB', 'escaped/VVN', 'and/CC', 'wrapped/VVN', 'with/IN', 'quotes/NNS', './SENT', 'If/IN', 'the/DT', 'caller/NN', 'casts/VVZ', 'the/DT', 'parameter/NN', 'to/TO', 'int/NNS', 'it/PP', "won'/VVZ", 't/NN', 'get/VV', 'quoted/VVN', 'so/IN', 'it/PP', 'can/MD', 'be/VB', 'used/VVN', 'with/IN', 'the/DT', 'LIMIT/NN', 'clause/NN', 'as/IN', 'well/RB', './SENT', './SENT', '@/SYM', 'YourCommonSense/NP', 'Whatever/WDT', 'SQL/NP', 'preparing/VVG', 'library/NN', 'you/PP', 'use/VVP', "you'/NP", 'll/NNS', 'need/VVP', 'to/TO', 'tell/VV', 'it/PP', 'somehow/RB', 'how/WRB', 'to/TO', 'handle/VV', 'the/DT', 'supplied/VVN', 'parameters/NNS', './SENT', 'If/IN', 'it/PP', 'maps/VVZ', 'to/TO', 'the/DT', 'SQL/NP', 'prepare/VVP', 'statement/NN', ',/,', 'you/PP', 'still/RB', 'need/VVP', 'to/TO', 'tell/VV', 'it/PP', 'whether/IN', 'it/PP', 'should/MD', 'quote/VV', 'the/DT', 'value/NN', 'or/CC', 'not/RB', '(/(', 'string/NN', 'or/CC', 'number/NN', ')/)', './SENT', 'Otherwise/RB', 'it/PP', 'will/MD', 'need/VV', 'to/TO', 'parse/VV', 'the/DT', 'statement/NN', 'and/CC', 'decide/VV', 'based/VVN', 'on/IN', 'that/DT', './SENT', 'Anyway/RB', 'MySQL/NP', 'is/VBZ', 'happy/JJ', 'if/IN', 'you/PP', 'quote/VVP', 'everything/NN', './SENT', '@/SYM', 'Kermani/NP', 'It/PP', 'escapes/VVZ', 'quotes/NNS', 'correctly/RB', './SENT', 'If/IN', 'you/PP', 'can/MD', 'find/VV', 'a/DT', 'security/NN', 'hole/NN', 'in/IN', 'it/PP', ',/,', 'let/VV', 'me/PP', 'know/VV', './SENT']