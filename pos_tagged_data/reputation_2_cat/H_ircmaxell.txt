['Yes/UH', ',/,', 'except/IN', 'that/WDT', 'PDO/NP', "doesn'/NP", 't/NN', 'use/NN', 'real/JJ', 'prepared/VVN', 'statements/NNS', 'by/IN', 'default/NN', ';/:', '-/:', ')/)', './SENT', 'See/VV', 'my/PP$', 'answer/NN', 'below/IN', 'for/IN', 'a/DT', 'demonstration/NN', 'and/CC', 'explanation/NN', 'of/IN', 'an/DT', 'attack/NN', '.../:', 'The/DT', 'short/JJ', 'answer/NN', 'is/VBZ', 'NO/UH', ',/,', 'PDO/NP', 'prepares/VVZ', 'will/MD', 'not/RB', 'defend/VV', 'you/PP', 'from/IN', 'all/DT', 'possible/JJ', 'SQL-Injection/NN', 'attacks/NNS', './SENT', 'For/IN', 'certain/JJ', 'obscure/JJ', 'edge-cases/NNS', './SENT', "I'/NP", 'm/NN', 'adapting/VVG', 'this/DT', 'answer/NN', 'to/TO', 'talk/VV', 'about/IN', 'PDO/NP', '.../:', 'The/DT', 'long/JJ', 'answer/NN', "isn'/NP", 't/NN', 'so/RB', 'easy/JJ', './SENT', "It'/NP", 's/NNS', 'based/VVN', 'off/IN', 'an/DT', 'attack/NN', 'demonstrated/VVD', 'here/RB', './SENT', 'The/DT', 'Attack/NP', 'So/RB', ',/,', "let'/NP", 's/NNS', 'start/VVP', 'off/RP', 'by/IN', 'showing/VVG', 'the/DT', 'attack/NN', '.../:', '$/$', 'pdo-/JJ', ']/SYM', 'query/NN', '(/(', "'/POS", 'SET/NP', 'NAMES/NP', "gbk'/NP", ')/)', ';/:', '$/$', 'var/NN', '=/SYM', '"/\'\'', '\\/SYM', 'xbf/NP', '\\/SYM', 'x27/JJ', 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', '"/\'\'', ';/:', '$/$', 'query/NN', '=/SYM', "'/POS", 'SELECT/NNS', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', '?/SENT', 'LIMIT/NN', '1/CD', "'/''", ';/:', '$/$', 'stmt/JJ', '=/SYM', '$/$', 'pdo-/JJ', ']/SYM', 'prepare/VV', '(/(', '$/$', 'query/NN', ')/)', ';/:', '$/$', 'stmt-/JJ', ']/SYM', 'execute/VV', '(/(', 'array/NN', '(/(', '$/$', 'var/NN', ')/)', ')/)', ';/:', 'In/IN', 'certain/JJ', 'circumstances/NNS', ',/,', 'that/WDT', 'will/MD', 'return/VV', 'more/JJR', 'than/IN', '1/CD', 'row/NN', './SENT', "Let'/NP", 's/NNS', 'dissect/VVP', "what'/NP", 's/NNS', 'going/VVG', 'on/IN', 'here/RB', ':/:', 'Selecting/VVG', 'a/DT', 'Character/NP', 'Set/NP', '$/$', 'pdo-/JJ', ']/SYM', 'query/NN', '(/(', "'/POS", 'SET/NP', 'NAMES/NP', "gbk'/NP", ')/)', ';/:', 'For/IN', 'this/DT', 'attack/NN', 'to/TO', 'work/VV', ',/,', 'we/PP', 'need/VVP', 'the/DT', 'encoding/VVG', 'that/IN', 'the/DT', "server'/NP", 's/NN', 'expecting/VVG', 'on/IN', 'the/DT', 'connection/NN', 'both/CC', 'to/TO', 'encode/VV', "'/''", 'as/IN', 'in/IN', 'ASCII/NP', 'i/NP', './SENT', 'e/LS', './SENT', '0x27/JJ', 'and/CC', 'to/TO', 'have/VH', 'some/DT', 'character/NN', 'whose/WP$', 'final/JJ', 'byte/NN', 'is/VBZ', 'an/DT', 'ASCII/NN', '\\/SYM', 'i/FW', './SENT', 'e/LS', './SENT', '0x5c/NN', './SENT', 'As/IN', 'it/PP', 'turns/VVZ', 'out/RP', ',/,', 'there/EX', 'are/VBP', '5/CD', 'such/JJ', 'encodings/NNS', 'supported/VVN', 'in/IN', 'MySQL/NP', '5/CD', './SENT', '6/CD', 'by/IN', 'default/NN', ':/:', 'big5/JJ', ',/,', 'cp932/JJ', ',/,', 'gb2312/JJ', ',/,', 'bgk/NN', 'and/CC', 'sjis/NNS', './SENT', "We'/NP", 'll/NNS', 'select/VVP', 'gbk/NN', 'here/RB', './SENT', 'Now/RB', ',/,', "it'/NP", 's/NNS', 'very/RB', 'important/JJ', 'to/TO', 'note/VV', 'the/DT', 'use/NN', 'of/IN', 'SET/NP', 'NAMES/NP', 'here/RB', './SENT', 'This/DT', 'sets/VVZ', 'the/DT', 'character/NN', 'set/VVN', 'ON/IN', 'THE/DT', 'SERVER/NP', './SENT', 'There/EX', 'is/VBZ', 'another/DT', 'way/NN', 'of/IN', 'doing/VVG', 'it/PP', ',/,', 'but/CC', "we'/NP", 'll/NNS', 'get/VVP', 'there/RB', 'soon/RB', 'enough/JJ', './SENT', 'The/DT', 'Payload/NP', 'The/DT', 'payload/NN', "we'/NN", 're/IN', 'going/VVG', 'to/TO', 'use/VV', 'for/IN', 'this/DT', 'injection/NN', 'starts/VVZ', 'with/IN', 'the/DT', 'byte/NN', 'sequence/NN', '0xbf27/JJ', './SENT', 'In/IN', 'gbk/NN', ',/,', "that'/NP", 's/VVD', 'an/DT', 'invalid/JJ', 'multibyte/NN', 'character/NN', ';/:', 'in/IN', 'latin1/NN', ',/,', "it'/NP", 's/VVD', 'the/DT', 'string/NN', '¿/NN', "'/POS", './SENT', 'Note/NN', 'that/IN', 'in/IN', 'latin1/NN', 'and/CC', 'gbk/NN', ',/,', '0x27/JJ', 'on/IN', 'its/PP$', 'own/JJ', 'is/VBZ', 'a/DT', 'literal/NN', "'/POS", 'character/NN', './SENT', 'We/PP', 'have/VHP', 'chosen/VVN', 'this/DT', 'payload/NN', 'because/IN', ',/,', 'if/IN', 'we/PP', 'called/VVD', 'addslashes/NNS', '(/(', ')/)', 'on/IN', 'it/PP', ',/,', "we'/NP", 'd/SYM', 'insert/VV', 'an/DT', 'ASCII/NN', '\\/SYM', 'i/FW', './SENT', 'e/LS', './SENT', '0x5c/NN', ',/,', 'before/IN', 'the/DT', "'/''", 'character/NN', './SENT', 'So/IN', "we'/NP", 'd/SYM', 'wind/NN', 'up/RP', 'with/IN', '0xbf5c27/JJ', ',/,', 'which/WDT', 'in/IN', 'gbk/NN', 'is/VBZ', 'a/DT', 'two/CD', 'character/NN', 'sequence/NN', ':/:', '0xbf5c/NN', 'followed/VVN', 'by/IN', '0x27/JJ', './SENT', 'Or/CC', 'in/IN', 'other/JJ', 'words/NNS', ',/,', 'a/DT', 'valid/JJ', 'character/NN', 'followed/VVN', 'by/IN', 'an/DT', 'unescaped/NN', "'/POS", './SENT', 'But/CC', "we'/NP", 're/IN', 'not/RB', 'using/VVG', 'addslashes/NNS', '(/(', ')/)', './SENT', 'So/RB', 'on/IN', 'to/TO', 'the/DT', 'next/JJ', 'step/NN', '.../:', '$/$', 'stmt-/JJ', ']/SYM', 'execute/VV', '(/(', ')/)', 'The/DT', 'important/JJ', 'thing/NN', 'to/TO', 'realize/VV', 'here/RB', 'is/VBZ', 'that/IN', 'PDO/NP', 'by/IN', 'default/NN', 'does/VVZ', 'NOT/NP', 'do/VV', 'true/JJ', 'prepared/JJ', 'statements/NNS', './SENT', 'It/PP', 'emulates/VVZ', 'them/PP', '(/(', 'for/IN', 'MySQL/NP', ')/)', './SENT', 'Therefore/RB', ',/,', 'PDO/NP', 'internally/RB', 'builds/VVZ', 'the/DT', 'query/NN', 'string/NN', ',/,', 'calling/VVG', 'mysql_real_escape_string/NN', '(/(', ')/)', '(/(', 'the/DT', 'MySQL/NP', 'C/NP', 'API/NP', 'function/NN', ')/)', 'on/IN', 'each/DT', 'bound/JJ', 'string/NN', 'value/NN', './SENT', 'The/DT', 'C/NP', 'API/NP', 'call/NN', 'to/TO', 'mysql_real_escape_string/VVG', '(/(', ')/)', 'differs/VVZ', 'from/IN', 'addslashes/NNS', '(/(', ')/)', 'in/IN', 'that/WDT', 'it/PP', 'knows/VVZ', 'the/DT', 'connection/NN', 'character/NN', 'set/VVD', './SENT', 'So/RB', 'it/PP', 'can/MD', 'perform/VV', 'the/DT', 'escaping/VVG', 'properly/RB', 'for/IN', 'the/DT', 'character/NN', 'set/VVD', 'that/IN', 'the/DT', 'server/NN', 'is/VBZ', 'expecting/VVG', './SENT', 'However/RB', ',/,', 'up/RB', 'to/TO', 'this/DT', 'point/NN', ',/,', 'the/DT', 'client/NN', 'thinks/VVZ', 'that/IN', "we'/NNS", 're/IN', 'still/RB', 'using/VVG', 'latin1/JJ', 'for/IN', 'the/DT', 'connection/NN', ',/,', 'because/IN', 'we/PP', 'never/RB', 'told/VVD', 'it/PP', 'otherwise/RB', './SENT', 'We/PP', 'did/VVD', 'tell/VV', 'the/DT', 'server/NN', "we'/NN", 're/IN', 'using/VVG', 'gbk/NN', ',/,', 'but/CC', 'the/DT', 'client/NN', 'still/RB', 'thinks/VVZ', "it'/JJ", 's/NNS', 'latin1/JJ', './SENT', 'Therefore/RB', 'the/DT', 'call/NN', 'to/TO', 'mysql_real_escape_string/VVG', '(/(', ')/)', 'inserts/VVZ', 'the/DT', 'backslash/NN', ',/,', 'and/CC', 'we/PP', 'have/VHP', 'a/DT', 'free/JJ', 'hanging/NN', "'/POS", 'character/NN', 'in/IN', 'our/PP$', '"/``', 'escaped/VVN', '"/\'\'', 'content/NN', '!/SENT', 'In/IN', 'fact/NN', ',/,', 'if/IN', 'we/PP', 'were/VBD', 'to/TO', 'look/VV', 'at/IN', '$/$', 'var/NN', 'in/IN', 'the/DT', 'gbk/NN', 'character/NN', 'set/NN', ',/,', "we'/NP", 'd/NN', 'see/VVP', ':/:', "縗'/NP", 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', 'Which/WDT', 'is/VBZ', 'exactly/RB', 'what/WP', 'the/DT', 'attack/NN', 'requires/VVZ', './SENT', 'The/DT', 'Query/NP', 'This/DT', 'part/NN', 'is/VBZ', 'just/RB', 'a/DT', 'formality/NN', ',/,', 'but/CC', "here'/NP", 's/VVD', 'the/DT', 'rendered/VVN', 'query/NN', ':/:', 'SELECT/VV', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', "'/POS", "縗'/NP", 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', "'/POS", 'LIMIT/NN', '1/CD', 'Congratulations/NNS', ',/,', 'you/PP', 'just/RB', 'successfully/RB', 'attacked/VVN', 'a/DT', 'program/NN', 'using/VVG', 'PDO/NP', 'Prepared/NP', 'Statements/NP', '.../:', 'The/DT', 'Simple/NP', 'Fix/NP', 'Now/RB', ',/,', "it'/NP", 's/JJ', 'worth/NN', 'noting/VVG', 'that/IN', 'you/PP', 'can/MD', 'prevent/VV', 'this/DT', 'by/IN', 'disabling/VVG', 'emulated/VVN', 'prepared/JJ', 'statements/NNS', ':/:', '$/$', 'pdo-/JJ', ']/SYM', 'setAttribute/NN', '(/(', 'PDO/NP', ':/:', ':/:', 'ATTR_EMULATE_PREPARES/NP', ',/,', 'false/JJ', ')/)', ';/:', 'This/DT', 'will/MD', 'usually/RB', 'result/VV', 'in/IN', 'a/DT', 'true/JJ', 'prepared/JJ', 'statement/NN', '(/(', 'i/NP', './SENT', 'e/LS', './SENT', 'the/DT', 'data/NNS', 'being/VBG', 'sent/VVN', 'over/RP', 'in/IN', 'a/DT', 'separate/JJ', 'packet/NN', 'from/IN', 'the/DT', 'query/NN', ')/)', './SENT', 'However/RB', ',/,', 'be/VB', 'aware/JJ', 'that/IN', 'PDO/NP', 'will/MD', 'silently/RB', 'fallback/JJ', 'to/TO', 'emulating/VVG', 'statements/NNS', 'that/IN', 'MySQL/NP', "can'/NP", 't/NN', 'prepare/VVP', 'natively/RB', ':/:', 'those/DT', 'that/IN', 'it/PP', 'can/MD', 'are/VBP', 'listed/VVN', 'in/IN', 'the/DT', 'manual/JJ', ',/,', 'but/CC', 'beware/VV', 'to/TO', 'select/VV', 'the/DT', 'appropriate/JJ', 'server/NN', 'version/NN', ')/)', './SENT', 'The/DT', 'Correct/NP', 'Fix/NP', 'The/DT', 'problem/NN', 'here/RB', 'is/VBZ', 'that/IN', 'we/PP', "didn'/VVZ", 't/NN', 'call/VV', 'the/DT', 'C/NP', "API'/NP", 's/NN', 'mysql_set_charset/NN', '(/(', ')/)', 'instead/RB', 'of/IN', 'SET/NP', 'NAMES/NP', './SENT', 'If/IN', 'we/PP', 'did/VVD', ',/,', "we'/VVG", 'd/NN', 'be/VB', 'fine/RB', 'provided/VVN', 'we/PP', 'are/VBP', 'using/VVG', 'a/DT', 'MySQL/NP', 'release/NN', 'since/IN', '2006/CD', './SENT', 'If/IN', "you'/NP", 're/IN', 'using/VVG', 'an/DT', 'earlier/JJR', 'MySQL/NP', 'release/NN', ',/,', 'then/RB', 'a/DT', 'bug/NN', 'in/IN', 'mysql_real_escape_string/NN', '(/(', ')/)', 'meant/VVD', 'that/IN', 'invalid/JJ', 'multibyte/NN', 'characters/NNS', 'such/JJ', 'as/IN', 'those/DT', 'in/IN', 'our/PP$', 'payload/NN', 'were/VBD', 'treated/VVN', 'as/IN', 'single/JJ', 'bytes/NNS', 'for/IN', 'escaping/VVG', 'purposes/NNS', 'even/RB', 'if/IN', 'the/DT', 'client/NN', 'had/VHD', 'been/VBN', 'correctly/RB', 'informed/VVN', 'of/IN', 'the/DT', 'connection/NN', 'encoding/VVG', 'and/CC', 'so/RB', 'this/DT', 'attack/NN', 'would/MD', 'still/RB', 'succeed/VV', './SENT', 'The/DT', 'bug/NN', 'was/VBD', 'fixed/VVN', 'in/IN', 'MySQL/NP', '4/CD', './SENT', '1/LS', './SENT', '20/CD', ',/,', '5/CD', './SENT', '0/CD', './SENT', '22/CD', 'and/CC', '5/CD', './SENT', '1/LS', './SENT', '11/LS', './SENT', 'But/CC', 'the/DT', 'worst/JJS', 'part/NN', 'is/VBZ', 'that/IN', 'PDO/NP', "didn'/NP", 't/NN', 'expose/VVP', 'the/DT', 'C/NP', 'API/NP', 'for/IN', 'mysql_set_charset/NN', '(/(', ')/)', 'until/IN', '5/CD', './SENT', '3/LS', './SENT', '6/CD', ',/,', 'so/RB', 'in/IN', 'prior/JJ', 'versions/NNS', 'it/PP', 'cannot/MD', 'prevent/VV', 'this/DT', 'attack/NN', 'for/IN', 'every/DT', 'possible/JJ', 'command/NN', '!/SENT', "It'/NP", 's/NNS', 'now/RB', 'exposed/VVN', 'as/IN', 'a/DT', 'DSN/NP', 'parameter/NN', ',/,', 'which/WDT', 'should/MD', 'be/VB', 'used/VVN', 'instead/RB', 'of/IN', 'SET/NP', 'NAMES/NP', '.../:', 'The/DT', 'Saving/NP', 'Grace/NP', 'As/IN', 'we/PP', 'said/VVD', 'at/IN', 'the/DT', 'outset/NN', ',/,', 'for/IN', 'this/DT', 'attack/NN', 'to/TO', 'work/VV', 'the/DT', 'database/NN', 'connection/NN', 'must/MD', 'be/VB', 'encoded/VVN', 'using/VVG', 'a/DT', 'vulnerable/JJ', 'character/NN', 'set/NN', './SENT', 'utf8mb4/NN', 'is/VBZ', 'not/RB', 'vulnerable/JJ', 'and/CC', 'yet/RB', 'can/MD', 'support/VV', 'every/DT', 'Unicode/JJ', 'character/NN', ':/:', 'so/RB', 'you/PP', 'could/MD', 'elect/VV', 'to/TO', 'use/VV', 'that/DT', 'instead—but/NN', 'it/PP', 'has/VHZ', 'only/RB', 'been/VBN', 'available/JJ', 'since/IN', 'MySQL/NP', '5/CD', './SENT', '5/LS', './SENT', '3/LS', './SENT', 'An/DT', 'alternative/NN', 'is/VBZ', 'utf8/NN', ',/,', 'which/WDT', 'is/VBZ', 'also/RB', 'not/RB', 'vulnerable/JJ', 'and/CC', 'can/MD', 'support/VV', 'the/DT', 'whole/NN', 'of/IN', 'the/DT', 'Unicode/JJ', 'Basic/NP', 'Multilingual/NP', 'Plane/NP', './SENT', 'Alternatively/RB', ',/,', 'you/PP', 'can/MD', 'enable/VV', 'the/DT', 'NO_BACKSLASH_ESCAPES/NP', 'SQL/NP', 'mode/NN', ',/,', 'which/WDT', '(/(', 'amongst/IN', 'other/JJ', 'things/NNS', ')/)', 'alters/VVZ', 'the/DT', 'operation/NN', 'of/IN', 'mysql_real_escape_string/NN', '(/(', ')/)', './SENT', 'With/IN', 'this/DT', 'mode/NN', 'enabled/VVD', ',/,', '0x27/NNS', 'will/MD', 'be/VB', 'replaced/VVN', 'with/IN', '0x2727/JJ', 'rather/RB', 'than/IN', '0x5c27/JJ', 'and/CC', 'thus/RB', 'the/DT', 'escaping/VVG', 'process/NN', 'cannot/MD', 'create/VV', 'valid/JJ', 'characters/NNS', 'in/IN', 'any/DT', 'of/IN', 'the/DT', 'vulnerable/JJ', 'encodings/NNS', 'where/WRB', 'they/PP', 'did/VVD', 'not/RB', 'exist/VV', 'previously/RB', '(/(', 'i/NP', './SENT', 'e/LS', './SENT', '0xbf27/JJ', 'is/VBZ', 'still/RB', '0xbf27/JJ', 'etc/NN', './SENT', ')/)', '—so/NN', 'the/DT', 'server/NN', 'will/MD', 'still/RB', 'reject/VV', 'the/DT', 'string/NN', 'as/IN', 'invalid/NN', './SENT', 'However/RB', ',/,', 'see/VVP', '@/SYM', "eggyal'/JJ", 's/NN', 'answer/NN', 'for/IN', 'a/DT', 'different/JJ', 'vulnerability/NN', 'that/WDT', 'can/MD', 'arise/VV', 'from/IN', 'using/VVG', 'this/DT', 'SQL/NP', 'mode/NN', '(/(', 'albeit/IN', 'not/RB', 'with/IN', 'PDO/NP', ')/)', './SENT', 'Safe/JJ', 'Examples/NNS', 'The/DT', 'following/VVG', 'examples/NNS', 'are/VBP', 'safe/JJ', ':/:', 'mysql_query/NN', '(/(', "'/POS", 'SET/NP', 'NAMES/NP', 'utf8/NP', "'/POS", ')/)', ';/:', '$/$', 'var/NN', '=/SYM', 'mysql_real_escape_string/NN', '(/(', '"/``', '\\/SYM', 'xbf/NN', '\\/SYM', 'x27/JJ', 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', '"/\'\'', ')/)', ';/:', 'mysql_query/NP', '(/(', '"/``', 'SELECT/NN', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', "'/POS", '$/$', "var'/JJ", 'LIMIT/NN', '1/CD', '"/\'\'', ')/)', ';/:', 'Because/IN', 'the/DT', "server'/NP", 's/NN', 'expecting/VVG', 'utf8/NN', '.../:', 'mysql_set_charset/NP', '(/(', "'/POS", "gbk'/NN", ')/)', ';/:', '$/$', 'var/NN', '=/SYM', 'mysql_real_escape_string/NN', '(/(', '"/``', '\\/SYM', 'xbf/NN', '\\/SYM', 'x27/JJ', 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', '"/\'\'', ')/)', ';/:', 'mysql_query/NP', '(/(', '"/``', 'SELECT/NN', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', "'/POS", '$/$', "var'/JJ", 'LIMIT/NN', '1/CD', '"/\'\'', ')/)', ';/:', 'Because/IN', "we'/NP", 've/NNS', 'properly/RB', 'set/VVD', 'the/DT', 'character/NN', 'set/VVN', 'so/IN', 'the/DT', 'client/NN', 'and/CC', 'the/DT', 'server/NN', 'match/NN', './SENT', '$/$', 'pdo-/JJ', ']/SYM', 'setAttribute/NN', '(/(', 'PDO/NP', ':/:', ':/:', 'ATTR_EMULATE_PREPARES/NP', ',/,', 'false/JJ', ')/)', ';/:', '$/$', 'pdo-/JJ', ']/SYM', 'query/NN', '(/(', "'/POS", 'SET/NP', 'NAMES/NP', "gbk'/NP", ')/)', ';/:', '$/$', 'stmt/JJ', '=/SYM', '$/$', 'pdo-/JJ', ']/SYM', 'prepare/VV', '(/(', "'/POS", 'SELECT/NNS', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', '?/SENT', 'LIMIT/NN', '1/CD', "'/''", ')/)', ';/:', '$/$', 'stmt-/JJ', ']/SYM', 'execute/VV', '(/(', 'array/NN', '(/(', '"/``', '\\/SYM', 'xbf/NN', '\\/SYM', 'x27/JJ', 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', '"/\'\'', ')/)', ')/)', ';/:', 'Because/IN', "we'/NP", 've/NNS', 'turned/VVD', 'off/RB', 'emulated/VVN', 'prepared/JJ', 'statements/NNS', './SENT', '$/$', 'pdo/JJ', '=/SYM', 'new/JJ', 'PDO/NP', '(/(', "'/POS", 'mysql/NN', ':/:', 'host/NN', '=/SYM', 'localhost/NN', ';/:', 'dbname/NNS', '=/SYM', 'testdb/NN', ';/:', 'charset/NN', '=/SYM', "gbk'/NP", ',/,', '$/$', 'user/NN', ',/,', '$/$', 'password/NN', ')/)', ';/:', '$/$', 'stmt/JJ', '=/SYM', '$/$', 'pdo-/JJ', ']/SYM', 'prepare/VV', '(/(', "'/POS", 'SELECT/NNS', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', '?/SENT', 'LIMIT/NN', '1/CD', "'/''", ')/)', ';/:', '$/$', 'stmt-/JJ', ']/SYM', 'execute/VV', '(/(', 'array/NN', '(/(', '"/``', '\\/SYM', 'xbf/NN', '\\/SYM', 'x27/JJ', 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', '"/\'\'', ')/)', ')/)', ';/:', 'Because/IN', "we'/NP", 've/NNS', 'set/VVD', 'the/DT', 'character/NN', 'set/VVD', 'properly/RB', './SENT', '$/$', 'mysqli-/JJ', ']/SYM', 'query/NN', '(/(', "'/POS", 'SET/NP', 'NAMES/NP', "gbk'/NP", ')/)', ';/:', '$/$', 'stmt/JJ', '=/SYM', '$/$', 'mysqli-/JJ', ']/SYM', 'prepare/VV', '(/(', "'/POS", 'SELECT/NNS', '*/SYM', 'FROM/NP', 'test/NN', 'WHERE/NP', 'name/NN', '=/SYM', '?/SENT', 'LIMIT/NN', '1/CD', "'/''", ')/)', ';/:', '$/$', 'param/NN', '=/SYM', '"/\'\'', '\\/SYM', 'xbf/NP', '\\/SYM', 'x27/JJ', 'OR/NP', '1/CD', '=/SYM', '1/CD', '//SYM', '*/SYM', '"/\'\'', ';/:', '$/$', 'stmt-/JJ', ']/SYM', 'bind_param/NN', '(/(', "'/POS", "s'/NP", ',/,', '$/$', 'param/NN', ')/)', ';/:', '$/$', 'stmt-/JJ', ']/SYM', 'execute/VV', '(/(', ')/)', ';/:', 'Because/IN', 'MySQLi/NP', 'does/VVZ', 'true/JJ', 'prepared/JJ', 'statements/NNS', 'all/PDT', 'the/DT', 'time/NN', './SENT', 'Wrapping/VVG', 'Up/RP', 'If/IN', 'you/PP', ':/:', 'Use/VV', 'Modern/NP', 'Versions/NNS', 'of/IN', 'MySQL/NP', '(/(', 'late/RB', '5/CD', './SENT', '1/CD', ',/,', 'all/RB', '5/CD', './SENT', '5/CD', ',/,', '5/CD', './SENT', '6/CD', ',/,', 'etc/FW', ')/)', 'AND/CC', "PDO'/NP", 's/JJ', 'DSN/NP', 'charset/NN', 'parameter/NN', '(/(', 'in/IN', 'PHP/NP', '≥/NP', '5/CD', './SENT', '3/LS', './SENT', '6/CD', ')/)', 'OR/NP', "Don'/NP", 't/NN', 'use/VVP', 'a/DT', 'vulnerable/JJ', 'character/NN', 'set/VVN', 'for/IN', 'connection/NN', 'encoding/VVG', '(/(', 'you/PP', 'only/RB', 'use/VVP', 'utf8/NP', '//SYM', 'latin1/NN', '//SYM', 'ascii/NN', '//SYM', 'etc/FW', ')/)', 'OR/NP', 'Enable/NP', 'NO_BACKSLASH_ESCAPES/NP', 'SQL/NP', 'mode/NN', "You'/NP", 're/IN', '100/CD', '%/NN', 'safe/JJ', './SENT', 'Otherwise/RB', ',/,', "you'/NNS", 're/IN', 'vulnerable/JJ', 'even/RB', 'though/IN', "you'/NP", 're/IN', 'using/VVG', 'PDO/NP', 'Prepared/NP', 'Statements/NP', '.../:', 'Addendum/NP', "I'/NP", 've/NN', 'been/VBN', 'slowly/RB', 'working/VVG', 'on/IN', 'a/DT', 'patch/NN', 'to/TO', 'change/VV', 'the/DT', 'default/NN', 'to/TO', 'not/RB', 'emulate/VV', 'prepares/VVZ', 'for/IN', 'a/DT', 'future/JJ', 'version/NN', 'of/IN', 'PHP/NP', './SENT', 'The/DT', 'problem/NN', 'that/IN', "I'/NP", 'm/NN', 'running/VVG', 'into/IN', 'is/VBZ', 'that/IN', 'a/DT', 'LOT/NN', 'of/IN', 'tests/NNS', 'break/VVP', 'when/WRB', 'I/PP', 'do/VVP', 'that/RB', './SENT', 'One/CD', 'problem/NN', 'is/VBZ', 'that/IN', 'emulated/VVN', 'prepares/VVZ', 'will/MD', 'only/RB', 'throw/VV', 'syntax/NN', 'errors/NNS', 'on/IN', 'execute/VV', ',/,', 'but/CC', 'true/RB', 'prepares/VVZ', 'will/MD', 'throw/VV', 'errors/NNS', 'on/RB', 'prepare/VVP', './SENT', 'So/RB', 'that/IN', 'can/MD', 'cause/VV', 'issues/NNS', '(/(', 'and/CC', 'is/VBZ', 'part/NN', 'of/IN', 'the/DT', 'reason/NN', 'tests/NNS', 'are/VBP', 'borking/VVG', ')/)', './SENT', '@/SYM', 'nicogawenda/NN', ':/:', 'that/WDT', 'was/VBD', 'a/DT', 'different/JJ', 'bug/NN', './SENT', 'Prior/RB', 'to/TO', '5/CD', './SENT', '0/CD', './SENT', '22/CD', ',/,', 'mysql_real_escape_string/VVG', "wouldn'/NP", 't/NN', 'properly/RB', 'handle/VV', 'cases/NNS', 'where/WRB', 'the/DT', 'connection/NN', 'was/VBD', 'properly/RB', 'set/VVN', 'to/TO', 'BIG5/NP', '//SYM', 'GBK/NP', './SENT', 'So/RB', 'actually/RB', 'even/RB', 'calling/VVG', 'mysql_set_charset/NN', '(/(', ')/)', 'on/IN', 'mysql/NP', '[/SYM', '5/CD', './SENT', '0/CD', './SENT', '22/CD', 'would/MD', 'be/VB', 'vulnerable/JJ', 'to/TO', 'this/DT', 'bug/NN', '!/SENT', 'So/RB', 'no/RB', ',/,', 'this/DT', 'post/NN', 'is/VBZ', 'still/RB', 'applicable/JJ', 'to/TO', '5/CD', './SENT', '0/CD', './SENT', '22/CD', '(/(', 'because/IN', 'mysql_real_escape_string/NN', 'is/VBZ', 'only/RB', 'charset/JJ', 'away/RB', 'to/TO', 'calls/NNS', 'from/IN', 'mysql_set_charset/NN', '(/(', ')/)', ',/,', 'which/WDT', 'is/VBZ', 'what/WP', 'this/DT', 'post/NN', 'is/VBZ', 'talking/VVG', 'about/IN', 'bypassing/VVG', ')/)', '.../:']