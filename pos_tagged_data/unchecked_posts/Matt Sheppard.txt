You/PRP 've/VBP got/VBN two/CD options/NNS -/: escaping/VBG the/DT special/JJ characters/NNS in/IN your/PRP$ unsafe_variable/JJ ,/, or/CC using/VBG a/DT parameterized/JJ query/NN ./.
Both/DT would/MD protect/VB you/PRP from/IN SQL/NN injection/NN ./.
The/DT parameterized/JJ query/NN is/VBZ considered/VBN the/DT better/JJR practice/NN ,/, but/CC escaping/VBG characters/NNS in/IN your/PRP$ variable/NN will/MD require/VB fewer/JJR changes/NNS ./.
We/PRP 'll/MD do/VB the/DT simpler/JJR string/NN escaping/VBG one/CD first/JJ ./.
//: //: Connect/VB $/$ unsafe_variable/JJ =/JJ $/$ _/CD POST/NN -LSB-/-LRB- ``/`` user-input/JJ ''/'' -RSB-/-RRB- ;/: $/$ safe_variable/JJ =/JJ mysql_real_escape_string/NN -LRB-/-LRB- $/$ unsafe_variable/JJ -RRB-/-RRB- ;/: mysql_query/NN -LRB-/-LRB- ``/`` INSERT/NNP INTO/NNP table/NN -LRB-/-LRB- column/NN -RRB-/-RRB- VALUES/NNS -LRB-/-LRB- '/'' ''/'' ./.
$/$ safe_variable/JJ ./. ''/'' '/'' -RRB-/-RRB- ''/'' -RRB-/-RRB-
;/: //: //: Disconnect/NNP See/NNP also/RB ,/, the/DT details/NNS of/IN the/DT mysql_real_escape_string/NN function/NN ./.
Warning/NN :/: As/IN of/IN PHP/FW 5.5.0/FW mysql_real_escape_string/NN and/CC the/DT mysql/JJ extension/NN are/VBP deprecated/VBN ./.
Please/VB use/VB mysqli/JJ extension/NN and/CC mysqli/NNS :/: :/: escape_string/NN function/NN instead/RB To/TO use/VB the/DT parameterized/JJ query/NN ,/, you/PRP need/VBP to/TO use/VB MySQLi/NN rather/RB than/IN the/DT MySQL/NN functions/NNS ./.
To/TO rewrite/VB your/PRP$ example/NN ,/, we/PRP would/MD need/VB something/NN like/IN the/DT following/NN ./.
$/$ mysqli/JJ =/JJ new/JJ mysqli/NNS -LRB-/-LRB- ``/`` server/NN ''/'' ,/, ``/`` username/JJ ''/'' ,/, ``/`` password/NN ''/'' ,/, ``/`` database_name/NN ''/'' -RRB-/-RRB- ;/: //: //: TODO/NN -/: Check/VB that/DT connection/NN was/VBD successful/JJ ./.
$/$ unsafe_variable/JJ =/JJ $/$ _/CD POST/NN -LSB-/-LRB- ``/`` user-input/JJ ''/'' -RSB-/-RRB- ;/: $/$ stmt/NN =/JJ $/$ mysqli/JJ -/: >/JJR prepare/VB -LRB-/-LRB- ``/`` INSERT/NNP INTO/NNP table/NN -LRB-/-LRB- column/NN -RRB-/-RRB- VALUES/NNS -LRB-/-LRB- ?/. -RRB-/-RRB- ''/'' -RRB-/-RRB-
;/: //: //: TODO/NN check/NN that/IN $/$ stmt/JJ creation/NN succeeded/VBD //: //: ``/`` s/NN ''/'' means/VBZ the/DT database/NN expects/VBZ a/DT string/NN $/$ stmt/JJ -/: >/JJR bind_param/NN -LRB-/-LRB- ``/`` s/NN ''/'' ,/, $/$ unsafe_variable/JJ -RRB-/-RRB- ;/: $/$ stmt/JJ -/: >/JJR execute/VB -LRB-/-LRB- -RRB-/-RRB- ;/: $/$ stmt/JJ -/: >/JJR close/NN -LRB-/-LRB- -RRB-/-RRB- ;/: $/$ mysqli/JJ -/: >/JJR close/NN -LRB-/-LRB- -RRB-/-RRB- ;/: The/DT key/JJ function/NN you/PRP 'll/MD want/VB to/TO read/VB up/RP on/IN there/EX would/MD be/VB mysqli/JJ :/: :/: prepare/VB ./.
Also/RB ,/, as/IN others/NNS have/VBP suggested/VBN ,/, you/PRP may/MD find/VB it/PRP useful/easier/JJR to/TO step/VB up/RP a/DT layer/NN of/IN abstraction/NN with/IN something/NN like/IN PDO/NNP ./.
Please/VB note/NN that/IN the/DT case/NN you/PRP asked/VBD about/IN is/VBZ a/DT fairly/RB simple/JJ one/CD ,/, and/CC that/IN more/JJR complex/JJ cases/NNS may/MD require/VB more/RBR complex/JJ approaches/NNS ./.
In/IN particular/JJ :/: If/IN you/PRP want/VBP to/TO alter/VB the/DT structure/NN of/IN the/DT SQL/NN based/VBN on/IN user/NN input/NN ,/, parameterised/JJ queries/NNS are/VBP not/RB going/VBG to/TO help/VB ,/, and/CC the/DT escaping/VBG required/VBN is/VBZ not/RB covered/VBN by/IN mysql_real_escape_string/NN ./.
In/IN this/DT kind/NN of/IN case/NN you/PRP would/MD be/VB better/JJR off/IN passing/VBG the/DT user/NN 's/POS input/NN through/IN a/DT whitelist/NN to/TO ensure/VB only/RB `/`` safe/JJ '/'' values/NNS are/VBP allowed/VBN through/IN ./.
If/IN you/PRP use/VBP integers/NNS from/IN user/NN input/NN in/IN a/DT condition/NN and/CC take/VB the/DT mysql_real_escape_string/NN approach/NN ,/, you/PRP will/MD suffer/VB from/IN the/DT problem/NN described/VBN by/IN Polynomial/NNP in/IN the/DT comments/NNS below/IN ./.
This/DT case/NN is/VBZ trickier/JJR because/IN integers/NNS would/MD not/RB be/VB surrounded/VBN by/IN quotes/NNS ,/, so/IN you/PRP could/MD deal/VB with/IN by/IN validating/VBG that/IN the/DT user/NN input/NN contains/VBZ only/JJ digits/NNS ./.
There/EX are/VBP likely/JJ other/JJ cases/NNS I/PRP 'm/VBP not/RB aware/JJ of/IN ./.
You/PRP might/MD find/VB http://webappsec.org/projects/articles/091007.txt/NN a/DT useful/JJ resource/NN on/IN some/DT of/IN the/DT more/RBR subtle/JJ problems/NNS you/PRP can/MD encounter/VB ./.
Something/NN is/VBZ very/RB wrong/JJ in/IN PHP/NNP land/NN if/IN mysql_real_escape_string/NN does/VBZ n't/RB appropriately/RB escape/VB all/DT special/JJ characters/NNS ./.
That/DT said/VBD ,/, it/PRP 's/VBZ easier/JJR to/TO look/VB at/IN code/NN using/VBG parameterization/NN and/CC know/VBP that/IN it/PRP 's/VBZ correct/JJ than/IN code/NN using/VBG escaping/VBG functions/NNS ./.
I/PRP ca/MD n't/RB think/VB of/IN an/DT example/NN where/WRB they/PRP are/VBP ,/, but/CC have/VBP n't/RB looked/VBN into/IN it/PRP deeply/RB ./.
Cedric/NNP below/RB pointed/VBD out/RP webappsec.org/projects/articles/091007.txt/NN which/WDT may/MD provide/VB some/DT useful/JJ info/NN ./.
See/VB the/DT section/NN about/IN ``/`` ORDER/NN BY/NN ''/'' in/IN the/DT webappsec/JJ link/NN ,/, which/WDT applies/VBZ to/TO strings/NNS if/IN they/PRP are/VBP being/VBG inserted/VBN as/IN column/NN names/NNS ./.
See/VB also/RB Cedric/NNP 's/POS answer/NN below/IN stackoverflow.com/a/6565763/797/NNP Fair/NNP enough/RB -/: Sorry/JJ my/PRP$ answer/NN was/VBD n't/RB useful/JJ to/TO you/PRP ./.
In/IN the/DT context/NN of/IN the/DT original/JJ user/NN 's/POS question/NN I/PRP believe/VBP it/PRP provides/VBZ a/DT good/JJ intro/NN but/CC I/PRP 've/VBP no/DT intention/NN of/IN arguing/VBG the/DT point/NN ./.
If/IN you/PRP 're/VBP already/RB using/VBG mysqli/NNS then/RB you/PRP 've/VBP got/VBD access/NN to/TO the/DT parametrized/VBN query/NN stuff/NN -/: I/PRP 'd/MD really/RB encourage/VB you/PRP to/TO use/VB that/IN if/IN you/PRP can/MD ./.
Given/VBN a/DT string/NN of/IN JSON/NNP data/NNS ,/, how/WRB can/MD you/PRP safely/RB turn/VB that/DT string/NN into/IN a/DT JavaScript/NNP object/NN ?/.
Obviously/RB you/PRP can/MD do/VB this/DT unsafely/RB with/IN something/NN like/IN .../: var/NN obj/NN =/JJ eval/NN -LRB-/-LRB- ''/'' -LRB-/-LRB- ''/'' +/CC json/NN +/CC '/'' -RRB-/-RRB- '/'' -RRB-/-RRB- ;/: .../: but/CC that/DT leaves/VBZ us/PRP vulnerable/JJ to/TO the/DT json/NN string/NN containing/VBG other/JJ code/NN ,/, which/WDT it/PRP seems/VBZ very/RB dangerous/JJ to/TO simply/JJ eval/NN ./.
