I/PRP had/VBD previously/RB answered/VBN a/DT very/RB similar/JJ question/NN over/IN at/IN How/WRB can/MD I/PRP throttle/VB user/NN login/NN attempts/NNS in/IN PHP/ACR ./.
I/PRP 'll/MD reiterate/VB the/DT proposed/VBN solution/NN here/RB as/IN I/PRP believe/VBP many/JJ of/IN you/PRP will/MD find/VB it/PRP informational/JJ and/CC useful/JJ to/TO see/VB some/DT actual/JJ code/NN ./.
Please/VB bare/JJ in/IN mind/NN that/IN using/VBG a/DT CAPTCHA/ACR might/MD not/RB be/VB the/DT best/JJS solution/NN due/JJ to/TO the/DT increasingly/RB accurate/JJ algorithms/NNS being/VBG used/VBN in/IN CAPTCHA/ACR busters/NNS nowadays/RB :/: You/PRP can/MD not/RB simply/RB prevent/VB DoS/ACR attacks/NNS by/IN chaining/VBG throttling/VBG down/RP to/TO a/DT single/JJ IP/ACR or/CC username/JJ ./.
Hell/NN ,/, you/PRP ca/MD n't/RB even/RB really/RB prevent/VB rapid-fire/JJ login/NN attempts/NNS using/VBG this/DT method/NN ./.
Why/WRB ?/.
Because/IN the/DT attack/NN can/MD span/VB multiple/JJ IPs/ACR and/CC user/NN accounts/NNS for/IN the/DT sake/NN of/IN bypassing/VBG your/PRP$ throttling/VBG attempts/NNS ./.
I/PRP have/VBP seen/VBN posted/VBN elsewhere/RB that/IN ideally/RB you/PRP should/MD be/VB tracking/VBG all/DT failed/VBN login/NN attempts/NNS across/IN the/DT site/NN and/CC associating/VBG them/PRP to/TO a/DT timestamp/NN ,/, perhaps/RB :/: CREATE/COB TABLE/COB failed_logins/COB -LRB-/COB id/COB INT/COB -LRB-/COB 11/COB -RRB-/COB UNSIGNED/COB NOT/COB NULL/COB AUTO_INCREMENT/COB PRIMARY/COB KEY/COB ,/COB username/COB VARCHAR/COB -LRB-/COB 16/COB -RRB-/COB NOT/COB NULL/COB ,/COB ip_address/COB INT/COB -LRB-/COB 11/COB -RRB-/COB UNSIGNED/COB NOT/COB NULL/COB ,/COB attempted/COB DATETIME/COB NOT/COB NULL/COB -RRB-/COB engine/COB =/COB InnoDB/COB charset/COB =/COB UTF8/COB ;/COB Decide/VB on/IN certain/JJ delays/NNS based/VBN on/IN the/DT overall/JJ number/NN of/IN failed/JJ logins/NNS in/IN a/DT given/VBN amount/NN of/IN time/NN ./.
You/PRP should/MD base/VB this/DT on/IN statistical/JJ data/NNS pulled/VBN from/IN your/PRP$ failed_logins/COS table/NN as/IN it/PRP will/MD change/VB over/IN time/NN based/VBN on/IN the/DT number/NN of/IN users/NNS and/CC how/WRB many/JJ of/IN them/PRP can/MD recall/VB -LRB-/-LRB- and/CC type/NN -RRB-/-RRB- their/PRP$ password/NN ./.
10/CD failed/JJ attempts/NNS =/SYM 1/CD second/JJ 20/CD failed/JJ attempts/NNS =/SYM 2/CD seconds/NNS 30/CD failed/VBN attempts/NNS =/SYM reCaptcha/ACR Query/NN the/DT table/NN on/IN every/DT failed/VBN login/NN attempt/NN to/TO find/VB the/DT number/NN of/IN failed/JJ logins/NNS for/IN a/DT given/VBN period/NN of/IN time/NN ,/, say/VBP 15/CD minutes/NNS :/: SELECT/COB COUNT/COB -LRB-/COB 1/COB -RRB-/COB AS/COB failed/COB FROM/COB failed_logins/COB WHERE/COB attempted/COB >/COB DATE_SUB/COB -LRB-/COB NOW/COB -LRB-/COB -RRB-/COB ,/COB INTERVAL/COB 15/COB minute/COB -RRB-/COB ;/COB If/IN the/DT number/NN of/IN attempts/NNS over/IN the/DT given/VBN period/NN of/IN time/NN is/VBZ over/IN your/PRP$ limit/NN ,/, either/CC enforce/VB throttling/VBG or/CC force/VB all/DT user/NN 's/POS to/TO use/VB a/DT captcha/ACR -LRB-/-LRB- i.e./FW reCaptcha/ACR -RRB-/-RRB- until/IN the/DT number/NN of/IN failed/JJ attempts/NNS over/IN the/DT given/VBN time/NN period/NN is/VBZ less/JJR than/IN the/DT threshold/NN ./.
//COB //COB array/COB of/COB throttling/COB $/COB throttle/COB =/COB array/COB -LRB-/COB 10/COB =/COB >/COB 1/COB ,/COB 20/COB =/COB >/COB 2/COB ,/COB 30/COB =/COB >/COB `/COB recaptcha/COB '/COB -RRB-/COB ;/COB //COB //COB assume/VB query/JJ result/NN of/IN $/COS sql/COS is/VBZ stored/VBN in/IN $/COB row/COB $/COB sql/COB =/COB `/COB SELECT/COB MAX/COB -LRB-/COB attempted/COB -RRB-/COB AS/COB attempted/COB FROM/COB failed_logins/COB '/COB ;/COB $/COB latest_attempt/COB =/COB -LRB-/COB int/COB -RRB-/COB date/COB -LRB-/COB `/COB U/COB '/COB ,/COB strtotime/COB -LRB-/COB $/COB row/COB -LSB-/COB `/COB attempted/COB '/COB -RSB-/COB -RRB-/COB -RRB-/COB ;/COB //COB //COB get/VB the/DT number/NN of/IN failed/JJ attempts/NNS $/COB sql/COB =/COB `/COB SELECT/COB COUNT/COB -LRB-/COB 1/COB -RRB-/COB AS/COB failed/COB FROM/COB failed_logins/COB WHERE/COB attempted/COB >/COB DATE_SUB/COB -LRB-/COB NOW/COB -LRB-/COB -RRB-/COB ,/COB INTERVAL/COB 15/COB minute/COB -RRB-/COB '/COB ;/COB //COB //COB assume/VB the/DT number/NN of/IN failed/VBN attempts/NNS was/VBD stored/VBN in/IN $/COB failed_attempts/COB krsort/COB -LRB-/COB $/COB throttle/COB -RRB-/COB ;/COB foreach/COB -LRB-/COB $/COB throttle/COB as/COB $/COB attempts/COB =/COB >/COB $/COB delay/COB -RRB-/COB -LCB-/COB if/COB -LRB-/COB $/COB failed_attempts/COB >/COB $/COB attempts/COB -RRB-/COB -LCB-/COB //COB //COB we/PRP need/VBP to/TO throttle/VB based/VBN on/IN delay/NN if/COB -LRB-/COB is_numeric/COB -LRB-/COB $/COB delay/COB -RRB-/COB -RRB-/COB -LCB-/COB $/COB remaining_delay/COB =/COB time/COB -LRB-/COB -RRB-/COB -/COB $/COB latest_attempt/COB -/COB $/COB delay/COB ;/COB //COB //COB output/NN remaining/VBG delay/NN echo/VBP `/`` You/PRP must/MD wait/VB '/'' ./.
$/COB remaining_delay/COB ./COB '/COB
seconds/NNS before/IN your/PRP$ next/JJ login/NN attempt/NN '/'' ;/COB -RCB-/COB else/COB -LCB-/COB //COB //COB code/NN to/TO display/VB recaptcha/ACR on/IN login/NN form/NN goes/VBZ here/RB -RCB-/-RRB- break/NN ;/: -RCB-/-RRB- -RCB-/-RRB- Using/VBG reCaptcha/ACR at/IN a/DT certain/JJ threshold/NN would/MD ensure/VB that/IN an/DT attack/NN from/IN multiple/JJ fronts/NNS would/MD be/VB minimized/VBN and/CC normal/JJ site/NN users/NNS would/MD not/RB experience/VB a/DT significant/JJ delay/NN for/IN legitimate/JJ failed/JJ login/NN attempts/NNS ./.
I/PRP ca/MD n't/RB gaurantee/VB prevention/NN ,/, as/IN it/PRP 's/VBZ already/RB been/VBN expanded/VBN upon/IN that/DT CAPTCHA/ACR 's/POS can/MD be/VB busted/VBN ./.
There/EX are/VBP alternative/JJ solutions/NNS ,/, perhaps/RB a/DT variant/NN of/IN ``/`` Name/VB this/DT animal/NN ''/'' ,/, which/WDT could/MD work/VB quite/RB well/RB as/IN a/DT substitute/NN ./.
