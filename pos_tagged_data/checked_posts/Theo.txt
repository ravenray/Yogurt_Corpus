Use/VB prepared/JJ statements/NNS and/CC parameterized/JJ queries/NNS ./.
These/DT are/VBP SQL/ACR statements/NNS that/WDT are/VBP sent/VBN to/TO and/CC parsed/VBN by/IN the/DT database/NN server/NN separately/RB from/IN any/DT parameters/NNS ./.
This/DT way/NN it/PRP is/VBZ impossible/JJ for/IN an/DT attacker/NN to/TO inject/VB malicious/JJ SQL/ACR ./.
You/PRP basically/RB have/VBP two/CD options/NNS to/TO achieve/VB this/DT :/: Using/VBG PDO/ACR :/COB $/COB stmt/COB =/COB $/COB pdo/COB -/COB >/COB prepare/COB -LRB-/COB `/COB SELECT/COB */COB FROM/COB employees/COB WHERE/COB name/COB =/COB :/COB name/COB '/COB -RRB-/COB ;/COB $/COB stmt/COB -/COB >/COB execute/COB -LRB-/COB array/COB -LRB-/COB `/COB name/COB '/COB =/COB >/COB $/COB name/COB -RRB-/COB -RRB-/COB ;/COB foreach/COB -LRB-/COB $/COB stmt/COB as/COB $/COB row/COB -RRB-/COB -LCB-/COB //COB //COB do/VBP something/NN with/IN $/COB row/NN -RCB-/COB Using/VBG MySQLi/COS :/: $/COB stmt/COB =/COB $/COB dbConnection/COB -/COB >/COB prepare/COB -LRB-/COB `/COB SELECT/COB */COB FROM/COB employees/COB WHERE/COB name/COB =/COB ?/COB '/COB -RRB-/COB
;/COB $/COB stmt/COB -/COB >/COB bind_param/COB -LRB-/COB 's/COB '/COB ,/COB $/COB name/COB -RRB-/COB ;/COB $/COB stmt/COB -/COB >/COB execute/COB -LRB-/COB -RRB-/COB ;/COB $/COB result/COB =/COB $/COB stmt/COB -/COB >/COB get_result/COB -LRB-/COB -RRB-/COB ;/COB while/COB -LRB-/COB $/COB row/COB =/COB $/COB result/COB -/COB >/COB fetch_assoc/COB -LRB-/COB -RRB-/COB -RRB-/COB -LCB-/COB //COB //COB do/VBP something/NN with/IN $/COB row/NN -RCB-/COB Correctly/RB setting/VBG up/RP the/DT connection/NN Note/VBP that/WDT when/WRB using/VBG PDO/ACR to/TO access/VB a/DT MySQL/COS database/NN real/JJ prepared/JJ statements/NNS are/VBP not/RB used/VBN by/IN default/NN ./.
To/TO fix/VB this/DT you/PRP have/VBP to/TO disable/VB the/DT emulation/NN of/IN prepared/JJ statements/NNS ./.
An/DT example/NN of/IN creating/VBG a/DT connection/NN using/VBG PDO/ACR is/VBZ :/: $/COB dbConnection/COB =/COB new/COB PDO/COB -LRB-/COB `/COB mysql/COB :/COB dbname/COB =/COB dbtest/COB ;/COB host/COB =/COB 127.0.0.1/COB ;/COB charset/COB =/COB utf8/COB '/COB ,/COB `/COB user/COB '/COB ,/COB `/COB pass/COB '/COB -RRB-/COB ;/COB $/COB dbConnection/COB -/COB >/COB setAttribute/COB -LRB-/COB PDO/COB :/COB :/COB ATTR_EMULATE_PREPARES/COB ,/COB false/COB -RRB-/COB ;/COB $/COB dbConnection/COB -/COB >/COB setAttribute/COB -LRB-/COB PDO/COB :/COB :/COB ATTR_ERRMODE/COB ,/COB PDO/COB :/COB :/COB ERRMODE_EXCEPTION/COB -RRB-/COB ;/COB In/IN the/DT above/JJ example/NN the/DT error/NN mode/NN is/VBZ n't/RB strictly/RB necessary/JJ ,/, but/CC it/PRP is/VBZ advised/VBN to/TO add/VB it/PRP ./.
This/DT way/NN the/DT script/NN will/MD not/RB stop/VB with/IN a/DT Fatal/JJ Error/NN when/WRB something/NN goes/VBZ wrong/JJ ./.
And/CC it/PRP gives/VBZ the/DT developer/NN the/DT chance/NN to/TO catch/VB any/DT error/NN -LRB-/-LRB- s/NNS -RRB-/-RRB- which/WDT are/VBP thrown/VBN as/IN PDOExceptions/COS ./.
What/WP is/VBZ mandatory/JJ however/RB is/VBZ the/DT first/JJ setAttribute/COS -LRB-/COS -RRB-/COS line/NN ,/, which/WDT tells/VBZ PDO/ACR to/TO disable/VB emulated/JJ prepared/JJ statements/NNS and/CC use/VB real/JJ prepared/JJ statements/NNS ./.
This/DT makes/VBZ sure/RB the/DT statement/NN and/CC the/DT values/NNS are/VBP n't/RB parsed/VBN by/IN PHP/ACR before/IN sending/VBG it/PRP to/TO the/DT MySQL/COS server/NN -LRB-/-LRB- giving/VBG a/DT possible/JJ attacker/NN no/DT chance/NN to/TO inject/VB malicious/JJ SQL/ACR -RRB-/-RRB- ./.
Although/IN you/PRP can/MD set/VB the/DT charset/NN in/IN the/DT options/NNS of/IN the/DT constructor/NN ,/, it/PRP 's/VBZ important/JJ to/TO note/VB that/IN `/`` older/JJR '/'' versions/NNS of/IN PHP/ACR -LRB-/-LRB- </SYM 5.3.6/CD -RRB-/-RRB- silently/RB ignored/VBD the/DT charset/NN parameter/NN in/IN the/DT DSN/ACR ./.
Explanation/NN What/WP happens/VBZ is/VBZ that/IN the/DT SQL/ACR statement/NN you/PRP pass/VBP to/TO prepare/VB is/VBZ parsed/VBN and/CC compiled/VBN by/IN the/DT database/NN server/NN ./.
By/IN specifying/VBG parameters/NNS -LRB-/-LRB- either/CC a/DT ?/.
or/CC a/DT named/VBN parameter/NN like/IN :/: name/NN in/IN the/DT example/NN above/IN -RRB-/-RRB- you/PRP tell/VBP the/DT database/NN engine/NN where/WRB you/PRP want/VBP to/TO filter/NN on/IN ./.
Then/RB when/WRB you/PRP call/VBP execute/VB ,/, the/DT prepared/JJ statement/NN is/VBZ combined/VBN with/IN the/DT parameter/NN values/NNS you/PRP specify/VBP ./.
The/DT important/JJ thing/NN here/RB is/VBZ that/IN the/DT parameter/NN values/NNS are/VBP combined/VBN with/IN the/DT compiled/VBN statement/NN ,/, not/RB an/DT SQL/ACR string/NN ./.
SQL/ACR injection/NN works/VBZ by/IN tricking/VBG the/DT script/NN into/IN including/VBG malicious/JJ strings/NNS when/WRB it/PRP creates/VBZ SQL/ACR to/TO send/VB to/TO the/DT database/NN ./.
So/RB by/IN sending/VBG the/DT actual/JJ SQL/ACR separately/RB from/IN the/DT parameters/NNS ,/, you/PRP limit/VBP the/DT risk/NN of/IN ending/VBG up/RP with/IN something/NN you/PRP did/VBD n't/RB intend/VB ./.
Any/DT parameters/NNS you/PRP send/VBP when/WRB using/VBG a/DT prepared/JJ statement/NN will/MD just/RB be/VB treated/VBN as/IN strings/NNS -LRB-/-LRB- although/IN the/DT database/NN engine/NN may/MD do/VB some/DT optimization/NN so/IN parameters/NNS may/MD end/VB up/RP as/IN numbers/NNS too/RB ,/, of/IN course/NN -RRB-/-RRB- ./.
In/IN the/DT example/NN above/IN ,/, if/IN the/DT $/COS name/COS variable/NN contains/VBZ `/`` Sarah/NNP '/'' ;/: DELETE/COB FROM/COB employees/COB the/DT result/NN would/MD simply/RB be/VB a/DT search/NN for/IN the/DT string/NN ''/'' `/`` Sarah/NNP '/'' ;/: DELETE/COOS FROM/COS employees/COS ''/'' ,/, and/CC you/PRP will/MD not/RB end/VB up/RP with/IN an/DT empty/JJ table/NN ./.
Another/DT benefit/NN with/IN using/VBG prepared/JJ statements/NNS is/VBZ that/IN if/IN you/PRP execute/VBP the/DT same/JJ statement/NN many/JJ times/NNS in/IN the/DT same/JJ session/NN it/PRP will/MD only/RB be/VB parsed/VBN and/CC compiled/VBN once/RB ,/, giving/VBG you/PRP some/DT speed/NN gains/NNS ./.
Oh/UH ,/, and/CC since/IN you/PRP asked/VBD about/IN how/WRB to/TO do/VB it/PRP for/IN an/DT insert/NN ,/, here/RB 's/VBZ an/DT example/NN -LRB-/-LRB- using/VBG PDO/ACR -RRB-/-RRB- :/: $/COB preparedStatement/COB =/COB $/COB db/COB -/COB >/COB prepare/COB -LRB-/COB `/COB INSERT/COB INTO/COB table/COB -LRB-/COB column/COB -RRB-/COB VALUES/COB -LRB-/COB :/COB column/COB -RRB-/COB '/COB -RRB-/COB ;/COB $/COB preparedStatement/COB -/COB >/COB execute/COB -LRB-/COB array/COB -LRB-/COB `/COB column/COB '/COB =/COB >/COB $/COB unsafeValue/COB -RRB-/COB -RRB-/COB ;/COB php.net/manual/en/pdo.installation.php/COB PDO/ACR is/VBZ bundled/VBN by/IN default/NN since/IN PHP/ACR 5.1/CD ./.
Not/RB all/DT drivers/NNS for/IN all/DT databases/NNS may/MD be/VB installed/VBN ,/, but/CC if/IN your/PRP$ host/NN supports/VBZ MySQL/COS and/CC PHP/ACR later/RB than/IN 5.1/CD it/PRP would/MD be/VB very/RB surprising/JJ if/IN it/PRP did/VBD n't/RB have/VB the/DT MySQL/COS PDO/ACR driver/NN installed/VBN ./.
Create/VB a/DT page/NN with/IN phpinfo/COS -LRB-/COS -RRB-/COS ;/: and/CC view/VB it/PRP in/IN a/DT browser/NN ,/, look/NN for/IN PDO/ACR and/CC you/PRP will/MD see/VB info/NN on/IN which/WDT drivers/NNS are/VBP installed/VBN ./.
Can/MD you/PRP even/RB use/VB bound/VBN parameters/NNS without/IN using/VBG prepared/JJ statements/NNS ?/.
There/EX is/VBZ no/DT contradiction/NN ./.
Validate/VB input/NN ,/, and/CC use/VB parameterized/JJ queries/NNS ./.
You/PRP do/VBP n't/RB have/VB to/TO choose/VB either/CC or/CC ./.
