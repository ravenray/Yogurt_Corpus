<TEI>
  <teiHeader>
    <fileDesc>
      <titleStmt>
        <title>Using openssl what does “unable to write 'random state'” mean? [closed]</title>
        <author>Luke Francl</author>
      </titleStmt>
      <sourceDesc>
        <p> Pulled from StackOverflow: http://stackoverflow.com/questions/94445/using-openssl-what-does-unable-to-write-random-state-mean</p>
      </sourceDesc>
    </fileDesc>
    <listPerson>
      <person xml:id="Luke Francl" url="http://stackoverflow.com/users/17965/luke-francl">
        <signatureContent>
          <p>Reputation: <num>14.8k</num>Number of Gold Badges: <num>14</num>Number of Silver Badges: <num>58</num>Number of Bronze Badges: <num>88</num></p>
        </signatureContent>
      </person>
      <person xml:id="Ville Laurikari" url="http://stackoverflow.com/users/7446/ville-laurikari">
        <signatureContent>
          <p>Reputation: <num>15.8k</num>Number of Gold Badges: <num>5</num>Number of Silver Badges: <num>40</num>Number of Bronze Badges: <num>49</num></p>
        </signatureContent>
      </person>
      <person xml:id="Beachhouse" url="http://stackoverflow.com/users/783004/beachhouse">
        <signatureContent>
          <p>Reputation: <num>2,387</num>Number of Gold Badges: <num>2</num>Number of Silver Badges: <num>12</num>Number of Bronze Badges: <num>30</num></p>
        </signatureContent>
      </person>
      <person xml:id="joel" url="http://stackoverflow.com/users/1356315/joel">
        <signatureContent>
          <p>Reputation: <num>207</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>2</num>Number of Bronze Badges: <num>2</num></p>
        </signatureContent>
      </person>
      <person xml:id="nbanic" url="http://stackoverflow.com/users/3531904/nbanic">
        <signatureContent>
          <p>Reputation: <num>1,168</num>Number of Gold Badges: <num>1</num>Number of Silver Badges: <num>4</num>Number of Bronze Badges: <num>11</num></p>
        </signatureContent>
      </person>
      <person xml:id="HalfBrian" url="http://stackoverflow.com/users/46975/halfbrian">
        <signatureContent>
          <p>Reputation: <num>582</num>Number of Gold Badges: <num>1</num>Number of Silver Badges: <num>6</num>Number of Bronze Badges: <num>19</num></p>
        </signatureContent>
      </person>
         <person xml:id="diyism" url="http://stackoverflow.com/users/264181/diyism">
        <signatureContent>
          <p>Reputation: <num>4,222</num>Number of Gold Badges: <num>5</num>Number of Silver Badges: <num>28</num>Number of Bronze Badges: <num>34</num></p>
        </signatureContent>
      </person>
            <person xml:id="John Smith" url="http://stackoverflow.com/users/2639304/john-smith">
        <signatureContent>
          <p>Reputation: <num>1,612</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>14</num>Number of Bronze Badges: <num>37</num></p>
        </signatureContent>
      </person>
        <person xml:id="John" url="http://stackoverflow.com/users/546813/john">
        <signatureContent>
          <p>Reputation: <num>748</num>Number of Gold Badges: <num>1</num>Number of Silver Badges: <num>7</num>Number of Bronze Badges: <num>18</num></p>
        </signatureContent>
      </person>
              <person xml:id="Smalcat" url="http://stackoverflow.com/users/313545/smalcat">
        <signatureContent>
          <p>Reputation: <num>195</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>0</num>Number of Bronze Badges: <num>17</num></p>
        </signatureContent>
      </person>
        <person xml:id="jevon" url="http://stackoverflow.com/users/39531/jevon">
        <signatureContent>
          <p>Reputation: <num>1,650</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>17</num>Number of Bronze Badges: <num>31</num></p>
        </signatureContent>
      </person>
          <person xml:id="Moumit" url="http://stackoverflow.com/users/2052085/moumit">
        <signatureContent>
          <p>Reputation: <num>1,278</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>10</num>Number of Bronze Badges: <num>17</num></p>
        </signatureContent>
      </person>
       <person xml:id="Rocco The Taco" url="http://stackoverflow.com/users/1090213/rocco-the-taco">
        <signatureContent>
          <p>Reputation: <num>1,081</num>Number of Gold Badges: <num>3</num>Number of Silver Badges: <num>16</num>Number of Bronze Badges: <num>44</num></p>
        </signatureContent>
      </person>
         <person xml:id="Gilad sefti" url="http://stackoverflow.com/users/1233890/jivangilad">
        <signatureContent>
          <p>Reputation: <num>138</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>1</num>Number of Bronze Badges: <num>15</num></p>
        </signatureContent>
      </person>
         <person xml:id="jww" url="http://stackoverflow.com/users/608639/jww">
        <signatureContent>
          <p>Reputation: <num>30,595</num>Number of Gold Badges: <num>20</num>Number of Silver Badges: <num>93</num>Number of Bronze Badges: <num>194</num></p>
        </signatureContent>
      </person>
         <person xml:id="fotNelton" url="http://stackoverflow.com/users/271678/fotnelton">
        <signatureContent>
          <p>Reputation: <num>2,748</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>12</num>Number of Bronze Badges: <num>26</num></p>
        </signatureContent>
      </person>
            <person xml:id="symbiont" url="http://stackoverflow.com/users/2411916/symbiont">
        <signatureContent>
          <p>Reputation: <num>103</num>Number of Gold Badges: <num>1</num>Number of Silver Badges: <num>2</num>Number of Bronze Badges: <num>11</num></p>
        </signatureContent>
      </person>
         <person xml:id="Synetech" url="http://stackoverflow.com/users/119540/synetech">
        <signatureContent>
          <p>Reputation: <num>5,118</num>Number of Gold Badges: <num>5</num>Number of Silver Badges: <num>35</num>Number of Bronze Badges: <num>65</num></p>
        </signatureContent>
      </person>
      <person xml:id="Tim Cooper" url="http://stackoverflow.com/users/142162/tim-cooper">
        <signatureContent>
            <p>Reputation: <num>80.3k</num>Number of Gold Badges: <num>20</num>Number of Silver Badges: <num>154</num>Number of Bronze Badges: <num>174</num></p>
        </signatureContent>
      </person>
      <person xml:id="Jusuf" url="http://stackoverflow.com/users/816211/jusuf">
        <signatureContent>
          <p>Reputation: <num>81</num>Number of Gold Badges: <num>0</num>Number of Silver Badges: <num>1</num>Number of Bronze Badges: <num>1</num></p>
        </signatureContent>
      </person>
      <person xml:id="Zds" url="http://stackoverflow.com/users/639119/zds">
        <signatureContent>
          <p>Reputation: <num>2,964</num>Number of Gold Badges: <num>1</num>Number of Silver Badges: <num>11</num>Number of Bronze Badges: <num>21</num></p>
        </signatureContent>
      </person>
    </listPerson>
  </teiHeader>
  <text>
    <body>
      <div type="forum">
        <post when="2008-09-18 16:56:43Z" who="Luke Francl" revisedWhen="2011-06-10 10:08:56Z" revisedBy="nbanic" upVote="226" accepted="favorite"><p>I'm generating a self-signed SSL certificate to protect my server's admin section, and I keep getting this message from OpenSSL:unable to write 'random state'What does this mean? A quick Google search yields nothing useful, so I thought I'd try out the new Stack Overflow!This is on an Ubuntu server. I have upgraded libssl to fix the recent security vulnerability.<tag>openssl</tag></p></post>
      </div>
      <div type="moderator">
        <head>closed  as off topic by  Kev Jun 19 '12 at 22:56</head>
        <post when="2012-06-19 22:56:30Z" who="Kev"><p>Questions on Stack Overflow are expected to relate to programming within the scope  defined by the community .   Consider editing the question or leaving comments for improvement if you believe the question can be reworded to fit within the scope.   Read more about  reopening questions  here. If this question can be reworded to fit the rules in the  help center , please  edit the question .</p>
      </post>
      </div>
      <div type="answer">
        <post who="Ville Laurikari" when="2008-09-18 16:58:48Z" revisedWhen="2011-06-10 10:08:48Z" upVote="306" accepted="accepted">
          <p>In practice, the most common reason for this happening seems to be that the .rnd file in your home directory is owned by root rather than your account. The quick fix:

        sudo rm ~/.rnd
        For more information, here's the entry from the OpenSSL FAQ:

        Sometimes the openssl command line utility does not abort with a "PRNG not seeded" error message, but complains that it is "unable to write 'random state'". This message refers to the default seeding file (see previous answer). A possible reason is that no default filename is known because neither RANDFILE nor HOME is set. (Versions up to 0.9.6 used file ".rnd" in the current directory in this case, but this has changed with 0.9.6a.)
        So I would check RANDFILE, HOME, and permissions to write to those places in the filesystem.

        If everything seems to be in order, you could try running with strace and see what exactly is going on.</p>
        </post>
      </div>
      <div type="response">
        <post who="HalfBrian" when="2010-06-04 16:19:33Z" indentLevel="1" upVote="20">
          <p>My system was giving me this issue because the ".rnd" file was owned by root rather than my user.  A quick  sudo chown user:user ~/.rnd  made everything work out.</p>
        </post>
      </div>
      <div type="response">
        <post who="Luc M" when="2012-07-09 02:36:38Z" indentLevel="1" upVote="1">
          <p>I had the same problem as OP. I did the  sudo  thing and it worked. But why do I still have a  .rnd  directory iwned by root in my $HOME after I create a self-signed certificate ?</p>
        </post>
      </div>
      <div type="response">
        <post who="diyism" when="2013-06-21 09:04:19Z" indentLevel="1">
          <p>Yes, if you run from php web server, the user is www-data, and you should add "export" before every openssl: shell_exec('export RANDFILE=".rnd";openssl  ecparam -genkey -name secp256k1'))</p>
        </post>
      </div>
      <div type="response">
        <post who="John Smith" when="2013-09-25 19:28:32Z" indentLevel="1">
          <p>Maybe you can help me with this question  stackoverflow.com/questions/19013529/…</p>
        </post>
      </div>
      <div type="answer">
        <post who="Beachhouse" when="2011-11-21 18:25:23Z" upVote="153">
          <p>I know this question is on Linux, but on windows I had the same issue.  Turns out you have to start the command prompt in "Run As Administrator" mode for it to work.  Otherwise you get the same: unable to write 'random state' error.</p>
        </post>
      </div>
      <div type="response">
        <post who="John" when="2012-06-10 09:01:53Z" indentLevel="1" upVote="12">
          <p>It might not belong here but your answer helped me. +1 for you. Thanks.</p>
        </post>
      </div>
      <div type="response">
        <post who="Smalcat" when="2012-06-14 08:24:33Z" indentLevel="1" upVote="10">
          <p>I am running on windows as administrator but still get the error</p>
        </post>
      </div>
      <div type="response">
        <post who="Beachhouse" when="2012-08-28 21:46:34Z" indentLevel="1" upVote="3">
          <p>Being an administrator on the machine and using "Run As Administrator" are different.  "Run As Administrator" forces the program to run as an Administrator, otherwise even when you are an administrator, the prompt will run with a non-administrator  security clearance.</p>
        </post>
      </div>
      <div type="response">
        <post who="HVKotak" when="2013-01-21 04:50:12Z" indentLevel="1">
          <p>Great Beachhouse Thanks, It's work for me</p>
        </post>
      </div>
      <div type="response">
        <post who="jevon" when="2013-04-16 04:08:12Z" indentLevel="1" upVote="37">
          <p>If you are running in administrator mode and you are  still  receiving "Unable to write 'random state'", another solution is to  set RANDFILE=.rnd  before executing  openssl .</p>
        </post>
      </div>
      <div type="response">
        <post who="Moumit" when="2015-04-01 07:20:53Z" indentLevel="1" upVote="1">
          <p>These problem is solved but now i am getting error message  Unable to load certificates  when trying to generate pfx file .. can you please solve this..</p>
        </post>
      </div>
      <div type="answer">
        <post who="joel" when="2012-04-25 13:23:07Z" upVote="19">
          <p>One other issue on the Windows platform, make sure you are running your command prompt as an Administrative User! I don't know how many times this has bitten me...</p>
        </post>
      </div>
      <div type="response">
        <post who="Rocco The Taco" when="2012-09-07 09:19:43Z" indentLevel="1">
          <p>This was totally my issue, wish I'd googled it sooner, thanks!</p>
        </post>
      </div>
      <div type="response">
        <post who="jivangilad" when="2014-10-23 12:40:34Z" indentLevel="1">
          <p>This is my case too. Always forget...</p>
        </post>
      </div>
      <div type="response">
        <post who="Simon" when="2015-12-04 18:05:14Z" indentLevel="1">
          <p>Thanks - this worked for me.</p>
        </post>
      </div>
      <div type="response">
        <post who="jww" when="2016-03-18 07:37:19Z" indentLevel="1" upVote="2">
          <p>How many times have you re-answered a question with three other answers that state the same?</p>
        </post>
      </div>
      <div type="answer">
        <post revisedBy="nbanic" who="Luke Francl" when="2008-09-18 17:09:51Z" revisedWhen="2014-04-14 14:19:51Z" upVote="13">
          <p>Apparently, I needed to run OpenSSL as root in order for it to have permission to the seeding file.</p>
        </post>
      </div>
      <div type="response">
        <post who="fotNelton" when="2010-09-29 09:03:26Z" indentLevel="1" upVote="11">
          <p>It is more likely that you once  ran  it as root whereupon the .rnd file in your home-directory was created with permissions set for root only. This happened to me a while back. Deletion of .rnd solved the issue.</p>
        </post>
      </div>
      <div type="answer">
        <post who="Jusuf" revisedBy="Tim Cooper" when="2011-06-26 14:34:30Z" revisedWhen="2011-12-18 15:06:30Z" upVote="8">
          <p>I had the same thing on windows server. Then I figured out by changing the vars.bat which is:

set HOME=C:\Program Files (x86)\OpenVPN\easy-rsa

then redo from beginning and everything should be fine.
</p>
        </post>
      </div>
      <div type="response">
        <post who="symbiont" when="2014-05-13 02:15:40Z" indentLevel="1">
          <p>that was it! thanks. i made this change right in-between the "init-config" and "vars" commands, from the instructions (here:  openvpn.net/index.php/open-source/documentation/howto.html#pki ). must be because i installed the 32-bit version (which i prefer).</p>
        </post>
      </div>
      <div type="response">
        <post who="Synetech" when="2014-05-26 20:36:57Z" indentLevel="1" upVote="2">
          <p>That did the trick, and I did not have to run as admin. Thanks! In fact, I simply used  set HOME=.</p>
        </post>
      </div>
      <div type="answer">
        <post who="Zds" when="2011-04-04 10:26:42Z" upVote="3">
          <p>The problem for me was that I had .rnd in my home directory but it was owned by root. Deleting it and reissuing the openssl command fixed this.</p>
        </post>
      </div>
    </body>
  </text>
</TEI>
